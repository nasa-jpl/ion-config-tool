{"ast":null,"code":"import _classCallCheck from\"/Users/rlborgen/git/ionconfig/editor/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/rlborgen/git/ionconfig/editor/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/rlborgen/git/ionconfig/editor/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/rlborgen/git/ionconfig/editor/node_modules/@babel/runtime/helpers/esm/createSuper.js\";//        IonModel.jsx     IonModel React Component\n//\n//        Copyright (c) 2018, California Institute of Technology.\n//        ALL RIGHTS RESERVED.  U.S. Government Sponsorship\n//        acknowledged.\n//                                                                   \n//      Author: Rick Borgen, Jet Propulsion Laboratory         \n//                                                               \nimport React from'react';import{FormControl}from'react-bootstrap';import{Row,Col}from'react-bootstrap';import{Label,Button,ButtonToolbar}from'react-bootstrap';import{Table,Panel}from'react-bootstrap';import{Glyphicon}from'react-bootstrap';import PopoutWindow from'react-popout';import{saveAs}from\"file-saver\";import JSZip from\"jszip\";import{Alert}from'react-bootstrap';import SurveyPopout from'./SurveyPopout.jsx';import Config from'./Config.jsx';import Command from'./Command.jsx';import HostList from'./HostList.jsx';import IonNodeList from'./IonNodeList.jsx';import GraphList from'./GraphList.jsx';import cmdTypes from'./cmdTypes.json';import configTypes from'./configTypes.json';import paramTypes from'./paramTypes.json';import patterns from'./patterns.json';import selections from'./selections.json';import versions from'./ionVersions.json';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var IonModel=/*#__PURE__*/function(_React$Component){_inherits(IonModel,_React$Component);var _super=_createSuper(IonModel);function IonModel(props){var _this;_classCallCheck(this,IonModel);_this=_super.call(this,props);// props\n//  name\n_this.expand=function(){// activated by expand/contract shutter icon\nvar newState=Object.assign({},_this.state);var expandMode=_this.state.expandMode;if(expandMode)console.log(\"let's close-up ion model list!\");else console.log(\"let's expand ion mode list!\");newState.expandMode=!expandMode;// toggling flag changes render\n_this.setState(newState);};_this.edit=function(){// activated by Edit/Submit button\nvar newState=Object.assign({},_this.state);var editMode=_this.state.editMode;if(editMode)_this.submit();else{console.log(\"let's edit!\");newState.viewMode=true;// force viewing\n}newState.editMode=!editMode;// toggle mode\n_this.setState(newState);};_this.noedit=function(){// activated by Edit/Submit button\nvar newState=Object.assign({},_this.state);newState.editMode=false;// cancel editing\nnewState.viewMode=false;// cancel viewing\n_this.setState(newState);};_this.submit=function(){// callable by edit (above)\nconsole.log(\"submit ion model updates!\"+JSON.stringify(_this.state.desc));var ionModel={\"name\":_this.state.name,\"desc\":_this.state.desc,\"nextNodeNum\":_this.state.nextNodeNum,\"currentContacts\":_this.state.currentContacts};var tran={action:\"UPDATE-ION-MODEL\",ionModel:ionModel};_this.props.dispatch(tran);};_this.view=function(){// activated by view/hide button\nvar newState=Object.assign({},_this.state);var viewMode=_this.state.viewMode;if(viewMode)console.log(\"let's hide view panel!\");else console.log(\"let's show view panel!\");newState.viewMode=!viewMode;_this.setState(newState);};_this.showSurveys=function(){console.log(\">>show Surveys!\");var newMode=!_this.state.surveyMode;_this.setState({surveyMode:newMode});};_this.showPopout=function(){console.log(\">>show Popout!\");var newMode=!_this.state.showPopoutMode;if(!newMode){// time ot close?\nvar myPopout=window.open(\"\",\"POPOUT\");if(myPopout){console.log(\"myPopout lives!!\");myPopout.close();}else console.log(\"myPopout null-ish!!\");//myPopout.close();\n}_this.setState({showPopoutMode:newMode});};_this.saveModel=function(){console.log(\"save ION model!\");var modelObj=_this.makeModelObj();var modelJson=JSON.stringify(modelObj,null,2);var blob=new Blob([modelJson],{type:\"text/plain; charset=utf-8\"});var modelName=_this.state.name+\".json\";console.log(\"save ION model to: \"+modelName);saveAs(blob,modelName,true);// true = disable autoBOM\n};_this.saveConfigs=function(){console.log(\"let's save all config files in a zip file!\");var zip=new JSZip();var rootdir=zip.folder(_this.props.name);// the network name\n// build common contact graph\nvar graphKey=_this.props.currentContacts+\".cg\";var graphLines=_this.makeCmdLines(graphKey);// build config files node-by-node\nfor(var nodeKey in _this.props.nodes){var node=_this.props.nodes[nodeKey];var nodedir=rootdir.folder(node.id);var confKeys=node.configKeys;var lf=\"\\n\";// assign linefeed format for text files\nvar host=_this.props.hosts[node.hostKey];// get host object of node\nif(host.linefeed==='windows')// windows is different\nlf=\"\\r\\n\";for(var j=0;j<confKeys.length;j++){var configKey=confKeys[j];console.log(\"Saving config file: \"+configKey);var _cmdLines=_this.makeCmdLines(configKey);var _page=_cmdLines.join(lf)+lf;nodedir.file(configKey,_page);};var graphPage=graphLines.join(lf)+lf;nodedir.file(graphKey,graphPage);// add common contact graph\n// ... and build start scripts for each node\nvar startName=\"start_\"+nodeKey+\".sh\";console.log(\"Saving start file: \"+startName);var cmdLines=_this.makeStartLines(nodeKey);var page=cmdLines.join(lf)+lf;nodedir.file(startName,page);};var zipname=_this.props.name+\".zip\";zip.generateAsync({type:\"blob\"}).then(function(content){saveAs(content,zipname,true);// true = disable autoBOM\n});console.log(\"finished zip file!??\");};_this.handleIonChange=function(prop,e){console.log(\"a value change of\"+prop+e);var newState=Object.assign({},_this.state);console.log(\">>> param old value = \"+newState.desc);newState[prop]=e.target.value;_this.setState(newState);e.preventDefault();};console.log(\"IonModel ctor\");_this.state={name:_this.props.name,desc:_this.props.desc,nextNodeNum:_this.props.nextNodeNum,currentContacts:_this.props.currentContacts,editMode:false,viewMode:false,surveyMode:false,showPopoutMode:false,expandMode:false};return _this;}_createClass(IonModel,[{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(newProps){//console.log(\"IonModel componentWillReceiveProps\" + newProps.desc + ' ' + newProps.nextNodeNum);\nif(newProps.nextNodeNum!==this.state.nextNodeNum){var newState=Object.assign({},this.state);newState.nextNodeNum=newProps.nextNodeNum;// only field updated externally\nthis.setState(newState);}return null;}},{key:\"makeModelObj\",value:function makeModelObj(){console.log(\"makeUserModel net:\"+this.state.name);var hosts=this.props.hosts;var ipaddrs=this.props.ipaddrs;var graphs=this.props.graphs;var nodes=this.props.nodes;var configs=this.props.configs;var model={};// user model built from current state\nmodel[\"ionModelName\"]=this.state.name;model[\"ionModelDesc\"]=this.state.desc;model[\"nextNodeNum\"]=this.state.nextNodeNum;model[\"currentContacts\"]=this.state.currentContacts;model[\"hosts\"]=[];model[\"nodes\"]=[];model[\"graphs\"]=[];for(var hostKey in hosts){var hostObj=hosts[hostKey];var hostJson={hostName:hostKey,hostDesc:hostObj.desc,linefeed:hostObj.linefeed,ipAddrs:[]};for(var addrKey in ipaddrs){if(ipaddrs[addrKey].hostKey===hostKey)hostJson[\"ipAddrs\"].push(ipaddrs[addrKey].ipAddr);}model[\"hosts\"].push(hostJson);}for(var nodeKey in nodes){var nodeObj=nodes[nodeKey];var nodeJson={nodeName:nodeKey,nodeDesc:nodeObj.longName,nodeNum:nodeObj.ionNodeNum,ionVersion:nodeObj.ionVersion,hostName:nodeObj.hostKey,configs:{}};var nodeConfigKeys=nodeObj.configKeys;for(var i=0;i<nodeConfigKeys.length;i++){var configKey=nodeConfigKeys[i];var configObj=configs[configKey];var configType=configObj.configType;var configJson=this.makeConfigObj(configKey);nodeJson.configs[configType]=configJson;}model[\"nodes\"].push(nodeJson);}for(var ctxKey in graphs){var ctxObj=graphs[ctxKey];var graphsJson={graphName:ctxKey,graphDesc:ctxObj.desc,ionVersion:ctxObj.ionVersion,configs:{}};var _configKey=ctxObj.configKey;// just one config\nconsole.log(\"graph configKey: \"+_configKey);var _configObj=configs[_configKey];var _configType=_configObj.configType;var _configJson=this.makeConfigObj(_configKey);graphsJson.configs[_configType]=_configJson;model[\"graphs\"].push(graphsJson);}return model;}},{key:\"makeConfigObj\",value:function makeConfigObj(configKey){var configs=this.props.configs;var commands=this.props.commands;var config={commands:[]};var configObj=configs[configKey];var configCmdKeys=configObj.cmdKeys;for(var j=0;j<configCmdKeys.length;j++){var cmdId=configCmdKeys[j];console.log(\"cmdId: \"+cmdId);var cmdObj=commands[cmdId];var userCmdObj={type:cmdObj.typeKey,lastUpdate:cmdObj.lastUpdate,parameters:cmdObj.values};config.commands.push(userCmdObj);}return config;}},{key:\"makeAlertElem\",value:function makeAlertElem(msg){return/*#__PURE__*/_jsx(Alert,{bsStyle:\"danger\",children:/*#__PURE__*/_jsxs(\"b\",{children:[\"ERROR: \",msg]})});}},{key:\"getIonVerSeqNo\",value:// tranlsate version to sequence number for command effectivity\nfunction getIonVerSeqNo(nodeKey){console.log(\"getIonVerSeqNo for:\"+nodeKey);var nodes=this.props.nodes;var graphs=this.props.graphs;if(!(nodes.hasOwnProperty(nodeKey)||graphs.hasOwnProperty(nodeKey)))return 0;var ver=0;if(nodeKey in nodes){var node=nodes[nodeKey];console.log(\"??? node: \"+JSON.stringify(node));ver=node.ionVersion;}else{var graph=graphs[nodeKey];console.log(\"??? graph: \"+JSON.stringify(graph));ver=graph.ionVersion;}console.log(\"???nodeKey: \"+nodeKey+\" ionVer: \"+ver);for(var seqno in versions){if(ver===versions[seqno].ionVersion)return seqno;}return 0;}},{key:\"isOptional\",value:function isOptional(paramTypeKey){var paramType=paramTypes[paramTypeKey];return paramType.optional;}},{key:\"makeHostListElem\",value:function makeHostListElem(name){console.log(\"makeHostListElem\");var hosts=this.props.hosts;// host objects\nvar ipaddrs=this.props.ipaddrs;// ipaddr objects\nvar isGoodName=this.props.isGoodName;// pass through\nvar makeOptElems=this.props.makeOptionElems;// pass through\nvar dispatch=this.props.dispatch;// pass through\nreturn/*#__PURE__*/_jsx(HostList,{// unique id\nname:name// user model - defaults to model name\n,hosts:hosts// user model - hosts\n,ipaddrs:ipaddrs// user model - ipaddrs\n,isGoodName:isGoodName// verify name string is valid\n,makeOptionElems:makeOptElems// static options building func\n,dispatch:dispatch// dispatch func for new hosts/ipaddrs\n},\"1\");}},{key:\"makeIonNodeListElem\",value:function makeIonNodeListElem(name){console.log(\"makeIonNodeListElem\");var contacts=this.props.currentContacts;// network contacts name\nvar nodes=this.props.nodes;// node objects\nvar hosts=this.props.hosts;// host objects\nvar configs=this.props.configs;// config objects\nvar commands=this.props.commands;// command objects\nvar ipaddrs=this.props.ipaddrs;// ipaddr objects\nvar isGoodName=this.props.isGoodName;// pass through\nvar isGoodNodeNum=this.props.isGoodNodeNum;// pass through\nvar makeCmdLines=this.makeCmdLines.bind(this);// remember this\nvar makeStarts=this.makeStartLines.bind(this);// remember this\nvar makeTypeOptions=this.props.makeTypeOptions;// pass through\nvar makeOptElems=this.props.makeOptionElems;// pass through\nvar makeConfigElem=this.makeConfigElem.bind(this);// remember this\nvar makeCommandElem=this.makeCommandElem.bind(this);// remember this\nvar makeParamProps=this.makeParamProps.bind(this);// remember this\nvar dispatch=this.props.dispatch;// pass through\nreturn/*#__PURE__*/_jsx(IonNodeList,{// unique id\nname:name// user model - defaults to model name\n,currentContacts:contacts// user model - network contacts name\n,nodes:nodes// user model - nodes\n,hosts:hosts// user model - hosts\n,configs:configs// user model - configs\n,commands:commands// user model - commands\n,ipaddrs:ipaddrs// user model - ipaddrs\n,configTypes:configTypes// schema\n,cmdTypes:cmdTypes// schema\n,paramTypes:paramTypes// schema\n,isGoodName:isGoodName// verify name string is valid\n,isGoodNodeNum:isGoodNodeNum// verify name string is valid\n,makeCmdLines:makeCmdLines// all lines formatting of config file\n,makeStartLines:makeStarts// all lines for a start script\n,makeTypeOptions:makeTypeOptions// get dynamic (cloned) options\n,makeOptionElems:makeOptElems// static options building func\n,makeConfigElem:makeConfigElem// build config elem\n,makeCommandElem:makeCommandElem// build command elem\n,makeParamProps:makeParamProps// build param props\n,dispatch:dispatch// dispatch func for new hosts/ipaddrs\n},\"2\");}},{key:\"makeGraphListElem\",value:function makeGraphListElem(name){console.log(\"makeGraphListElem\");var graphs=this.props.graphs;// graph objects\nvar configs=this.props.configs;// config objects\nvar commands=this.props.commands;// command objects\nvar isGoodName=this.props.isGoodName;// pass through\nvar makeCmdLines=this.makeCmdLines.bind(this);// remember this\nvar makeTypeOptions=this.props.makeTypeOptions;// pass through\nvar makeOptElems=this.props.makeOptionElems;// pass through\nvar makeConfigElem=this.makeConfigElem.bind(this);// remember this\nvar makeCommandElem=this.makeCommandElem.bind(this);// remember this\nvar makeParamProps=this.makeParamProps.bind(this);// remember this\nvar dispatch=this.props.dispatch;// pass through\nreturn/*#__PURE__*/_jsx(GraphList,{// unique id\nname:name// user model - defaults to model name\n,graphs:graphs// user model - graphs\n,configs:configs// user model - configs\n,commands:commands// user model - commands\n,isGoodName:isGoodName// verify name string is valid\n,makeCmdLines:makeCmdLines// all lines formatting of config file\n,makeTypeOptions:makeTypeOptions// get dynamic (cloned) options\n,makeOptionElems:makeOptElems// static options building func\n,makeConfigElem:makeConfigElem// build config elem\n,makeCommandElem:makeCommandElem// build command elem\n,makeParamProps:makeParamProps// build param props\n,dispatch:dispatch// dispatch func for new graphs\n},\"3\");}// build ION parameter annotation (commands file format)\n},{key:\"makeParamNote\",value:function makeParamNote(pTypeKey,pIdx,paramVal){// define padit here, because \"this\" can be weird\nfunction padit(w,str,pad){return w<=str.length?str:padit(w,pad+str,pad);};//console.log(\"makeParamNote: \" + pTypeKey + \" \" + pIdx + \" \" + paramVal);\nvar pType=paramTypes[pTypeKey];var longname=pType.name;longname=padit(34,longname,\" \");var position=pIdx+1;var posTag=\"[\"+position+\"]\";var units=\"\";if(pType.units!==\"\"){units=\"(\"+pType.units+\")\";}var descrip=\"\";var sels=undefined;if(pTypeKey in selections){sels=selections[pTypeKey];}if(sels){//console.log(\"makeParamNote sels: \" + JSON.stringify(sels));\nfor(var i=0;i<sels.length;i++){var select=sels[i];if(Object.keys(select)[0]===paramVal){descrip=\"[\"+select[paramVal]+\"]\";}}}var note=\"#  \"+posTag+\" \"+longname+\" : \"+paramVal+\" \"+units+\" \"+descrip;//console.log(\"param Note \" + pTypeKey + \" \" + note);\nreturn note;}// builds ION command text (commands file format)\n},{key:\"makeCmdLine\",value:function makeCmdLine(cmdTypeKey,cmdParams){// console.log(\"makeCmdLine cmdTypeKey: \" + cmdTypeKey + \"  Params : \" + JSON.stringify(cmdParams));\nvar targets=[\"[1]\",\"[2]\",\"[3]\",\"[4]\",\"[5]\",\"[6]\",\"[7]\",\"[8]\",\"[9]\"];var cmdPattern=patterns[cmdTypeKey];var cmdType=cmdTypes[cmdTypeKey];//console.log(\"cmdType: \" + JSON.stringify(cmdType));\nfor(var i=0;i<cmdParams.length;i++){//console.log(\"makeCmdLine Pattern: \" + cmdPattern + \" tgt: \" + cmdTypeKey + \"  \" + targets[i] + \"  \" + cmdParams[i]);\nvar paramTypeKey=cmdType.paramTypes[i];if(cmdParams[i]===\"\"){if(this.isOptional(paramTypeKey))cmdPattern=cmdPattern.replace(targets[i],\"\");else cmdPattern=cmdPattern.replace(targets[i],\"??\");}else cmdPattern=cmdPattern.replace(targets[i],cmdParams[i]);}//console.log(\"cmd Type pattern \" + cmdTypeKey + \" \" + cmd);\nreturn cmdPattern;}},{key:\"makeCmdLines\",value:function makeCmdLines(configKey){console.log(\"makeCmdLines for: \"+configKey);var configObj=this.props.configs[configKey];var cmdKeys=configObj.cmdKeys;var configTypeKey=configObj.configType;var configTypeObj=configTypes[configTypeKey];//console.log(\"makeConfigElem configType:\" + JSON.stringify(configType));\nvar modelName=this.state.name;var modelDesc=this.state.desc;var nodeKey=configObj.nodeKey;var node=this.props.nodes[nodeKey];var nodeDesc=\"\";var nodeLabel=\"\";if(node){// a node?,  might be a graphs key)    \nnodeDesc=this.props.nodes[nodeKey].longName;nodeLabel=\"ipn:\"+node.ionNodeNum;};var content=configTypeObj.content;var program=configTypeObj.program;var commands=this.props.commands;var now=new Date();var fileDate=now.format(\"YYYY-MM-DD hh:mm\");var cmdLines=[];// build header \ncmdLines.push(\"#  FILE:      \"+configObj.id);//console.log(\"makeCmdLines commands: \" + Object.keys(this.props.commands).length); \ncmdLines.push(\"#  CONTENT:   \"+content);cmdLines.push(\"#  FOR:       \"+program);cmdLines.push(\"#  BUILDER:   ION Configuration Editor\");cmdLines.push(\"#  NETWORK:   \"+modelName+\"    [\"+modelDesc+\"]\");if(node){cmdLines.push(\"#  NODE:      \"+nodeKey+\"    [\"+nodeDesc+\"]\");cmdLines.push(\"#  IPN:       \"+nodeLabel);}cmdLines.push(\"#  DATE:      \"+fileDate);// build commands\nfor(var i=0;i<cmdKeys.length;i++){var cmdKey=cmdKeys[i];//console.log(\"makeCmdLines i: \" + i + \" cmdKey: \" + cmdKey);\nvar cmd=commands[cmdKey];var cmdTypeKey=cmd.typeKey;//console.log(\"makeCmdLines cmdTypeKey: \" + cmdTypeKey);\nvar cmdType=cmdTypes[cmdTypeKey];var cmdName=cmdType.name;cmdLines.push(\"#\");cmdLines.push(\"#  \"+cmdName.toUpperCase());var pTypeKeys=cmdType.paramTypes;var cmdVals=cmd.values;for(var j=0;j<pTypeKeys.length;j++){var pTypeKey=pTypeKeys[j];var val=cmdVals[j];cmdLines.push(this.makeParamNote(pTypeKey,j,val));}cmdLines.push(this.makeCmdLine(cmdTypeKey,cmdVals));}return cmdLines;}// build the start script text lines for a node\n},{key:\"makeStartLines\",value:function makeStartLines(nodeKey){var node=this.props.nodes[nodeKey];var fileName=\"start_\"+nodeKey+\".sh\";var nodeLabel=\"ipn:\"+node.ionNodeNum;var now=new Date();var fileDate=now.format(\"YYYY-MM-DD hh:mm\");var cmdLines=[];cmdLines.push(\"#!/bin/bash\");cmdLines.push(\"#  FILE:  \"+fileName);cmdLines.push(\"#  NODE:  \"+nodeKey+\" [\"+nodeLabel+\"]\");cmdLines.push(\"#  DESC:  \"+node.longName);cmdLines.push(\"#  DATE:  \"+fileDate);cmdLines.push(\"host=`uname -n`\");cmdLines.push(\"wdir=`pwd`\");cmdLines.push('echo \"Clearing old ion.log\"');cmdLines.push(\"echo > ion.log\");var nodeConfigs=[];var configs=this.props.configs;for(var i=0;i<node.configKeys.length;i++){var configKey=node.configKeys[i];var configType=configs[configKey].configType;var order=configTypes[configType].start_order;var nodeConfig=configs[configKey];nodeConfig.order=order;if(configKey.indexOf(\"ionconfig\")<0)// add all except ionconfig\nnodeConfigs.push(nodeConfig);}nodeConfigs.sort(function(a,b){return a.order>b.order?1:-1;});console.log(\"makeStartLines sortConfigs: \"+JSON.stringify(nodeConfigs));for(var j=0;j<nodeConfigs.length;j++){var configObj=nodeConfigs[j];var _configKey2=configObj.id;console.log(\"makeStartLines configKey: \"+_configKey2);var configTypeKey=configObj.configType;var configTypeObj=configTypes[configTypeKey];var prog=configTypeObj.program;if(j===0)cmdLines.push('echo \"Starting ION node '+nodeLabel+' on $host from $wdir\"');else cmdLines.push(\"sleep  1\");cmdLines.push(prog+\"  \"+_configKey2);}// special case for (global) graphs file\nvar contacts=this.state.currentContacts;if(contacts!==\"\"){var contactsFile=contacts+\".cg\";cmdLines.push(\"sleep  1\");cmdLines.push(\"# global contact graph\");cmdLines.push(\"ionadmin  \"+contactsFile);}var nodeId=node.ionNodeNum;cmdLines.push('echo \"Startup of ION node '+nodeLabel+' on $host complete!\"');cmdLines.push('echo \"Starting bpecho on ipn:'+nodeId+'.3.\"');cmdLines.push('bpecho   ipn:'+nodeId+'.3 &');return cmdLines;}// build and return a Config file element\n},{key:\"makeConfigElem\",value:function makeConfigElem(configKey,cmdKeys,cmdsList){var config=this.props.configs[configKey];var configTypeKey=config.configType;var configType=configTypes[configTypeKey];var nodeKey=config.nodeKey;// note...nodeKey might NOT be a node (graphs)\nvar verSeqNo=this.getIonVerSeqNo(nodeKey);console.log(\"???the Version sequence Number is: \"+verSeqNo.toString()+\" for \"+configKey);var nodes=this.props.nodes;var host=null;if(nodes.hasOwnProperty(nodeKey)){var hostKey=nodes[nodeKey].hostKey;host=this.props.hosts[hostKey];}var makeCmdLines=this.makeCmdLines.bind(this);var getVer=this.getIonVerSeqNo.bind(this);var dispatch=this.props.dispatch;// make sure dispatch remembers \"this\"\nreturn/*#__PURE__*/_jsx(Config,{// unique id\nname:config.id// unique name of this config file\n,configType:configType// schema - config type object\n,nodeKey:nodeKey// user model - node key\n,host:host// user model - host object\n,cmdKeys:cmdKeys// list of command keys  for this config file\n,makeCmdLines:makeCmdLines// all lines formatting of config file\n,getIonVerSeqNo:getVer// get version seq num\n,dispatch:dispatch// dispatch func for new commands\n,children:cmdsList// list of command elements for this config file\n},configKey);}// build and return a Command element\n},{key:\"makeCommandElem\",value:function makeCommandElem(nodeKey,configKey,cmdKey,hostKey,paramPropsList){//console.log(\"makeCommandElem \" + cmdKey);\nvar cmd=this.props.commands[cmdKey];var cmdTypeKey=cmd.typeKey;var cmdType=cmdTypes[cmdTypeKey];var pattern=patterns[cmdTypeKey];var vals=this.props.getValues(cmdKey).slice(0);// a shallow copy of the values\nvar clones=this.props.cloneValues;// need to know if command value is cloned\n// functions need to remember \"this\", hence the bind\nvar makeCmd=this.makeCmdLine.bind(this);// func to build an ion cmd line\nvar getVals=this.props.getValues;// func to get values for command\nvar usedNodeKey=this.props.usedNodeKey;// func to check if nodekey in use\nvar makeTypeOpts=this.props.makeTypeOptions;// func to make dynamic clone option elems\nvar makeOptElems=this.props.makeOptionElems;// func to make static option elems\nvar getOptText=this.props.getOptionText;// func to get an option's text\nvar makePNote=this.makeParamNote;// func to make param note\nvar dispatch=this.props.dispatch;// pass through\nreturn/*#__PURE__*/_jsx(Command,{// unique id for command component\ncmdKey:cmdKey// unique id for command\n,nodeKey:nodeKey// unique id for node of command\n,hostKey:hostKey// unique id for host of node\n,configKey:configKey// unique key of config file\n,cmdType:cmdType// schema object for command type\n,cmdTypeKey:cmdTypeKey// commmand type key\n,initValues:vals// command values\n,cmdPattern:pattern// cmd pattern string\n,cloneValues:clones// cloneValues object\n,makeCmd:makeCmd// cmd formatting func\n,getValues:getVals// value retrieval func\n,usedNodeKey:usedNodeKey// node key check func\n,makeTypeOptions:makeTypeOpts// dynamic options building func\n,makeOptionElems:makeOptElems// static options building func\n,getOptionText:getOptText// get option's text func\n,makeParamNote:makePNote// parameter note function\n,dispatch:dispatch// dispatch of state updates\n,lastUpdate:cmd.lastUpdate// last update\n,params:paramPropsList},cmdKey);//\n}// initialize all Param props (will pass to Command to complete)\n// return Param Props object\n},{key:\"makeParamProps\",value:function makeParamProps(pTypeKey,value){//console.log(\"makeParamProps pTypeKey: \" + pTypeKey)\nvar paramType=paramTypes[pTypeKey];var def=paramType.defaultValue;var copyClone=paramType.copyClone;var pickClone=paramType.pickClone;var optional=paramType.optional;var showDefault=paramType.showDefault;//console.log(\"paramType= \" + pTypeKey + \" selections: \" + JSON.stringify(selections));\nreturn{\"name\":paramType.name,// schema\n\"typeKey\":pTypeKey,// user model\n\"valueType\":paramType.valType,// schema\n\"units\":paramType.units,// schema\n\"defaultValue\":def,// schema\n\"initVal\":value,// user model\n\"optional\":optional,// schema\n\"copyClone\":copyClone,// schema \n\"pickClone\":pickClone,// schema\n\"showDefault\":showDefault// schema                \n};}},{key:\"makeHeadElem\",value:function makeHeadElem(cols){var colElems=cols.map(function(name,idx){return/*#__PURE__*/_jsx(\"th\",{children:name},idx);});var headElem=/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:colElems})},\"head\");return headElem;}},{key:\"makeRowElem\",value:function makeRowElem(rowKey,data){var dataElems=data.map(function(name,idx){return/*#__PURE__*/_jsx(\"td\",{children:name},idx);});var rowElem=/*#__PURE__*/_jsx(\"tr\",{children:dataElems},rowKey);return rowElem;}},{key:\"makeShowPopout\",value:function makeShowPopout(){var report=this.makeShowNodes();return/*#__PURE__*/_jsx(PopoutWindow,{title:\"POPOUT\",options:{outerHeight:'400 px',outerWidth:'900 px'},onClosing:this.showPopout,children:report});}},{key:\"makeShowEndpoints\",value:function makeShowEndpoints(){//console.log(\"makeShowEndpoints\");\nvar epElemList=[];var cmds=[];var commandObjs=this.props.commands;for(var cmdKey in commandObjs){if(commandObjs[cmdKey].typeName==='endpoint')cmds.push(commandObjs[cmdKey]);};// first sort by service num\ncmds=cmds.sort(function(a,b){return Number(a.values[1])>Number(b.values[1])?1:Number(b.values[1])>Number(a.values[1])?-1:0;});// then sort by node num\ncmds=cmds.sort(function(a,b){return Number(a.values[0])>Number(b.values[0])?1:Number(b.values[0])>Number(a.values[0])?-1:0;});var configs=this.props.configs;var epCols=[\"Endpoint ID\",\"Node Name\",\"Service Num\",\"Disposition\",\"Queue Task\"];var headElem=this.makeHeadElem(epCols);for(var i=0;i<cmds.length;i++){var cmdObj=cmds[i];var configKey=cmdObj.configKey;var configObj=configs[configKey];var nodeKey=configObj.nodeKey;var nodeNum=cmdObj.values[0];var serviceNum=cmdObj.values[1];var id=\"ipn:\"+nodeNum+'.'+serviceNum;var dispCode=cmdObj.values[2];var disp=dispCode==='x'?\"discard\":\"queue\";var qTask=cmdObj.values[3];var epElem=this.makeRowElem(id,[id,nodeKey,serviceNum,disp,qTask]);epElemList.push(epElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:epElemList})]});}},{key:\"makeShowHosts\",value:function makeShowHosts(){//console.log(\"makeShowHosts\");\nvar hostElemList=[];var hostObjs=this.props.hosts;var nodeObjs=this.props.nodes;var hosts=Object.keys(hostObjs).map(function(key){return hostObjs[key];});var nodes=Object.keys(nodeObjs).map(function(key){return nodeObjs[key];});//  sort by hostKey\nhosts=hosts.sort(function(a,b){return a.id>b.id?1:b.id>a.id?-1:0;});var hostCols=[\"Host Name\",\"Description\",\"Linefeed\",\"Nodes\",\"IP Addresses\"];var headElem=this.makeHeadElem(hostCols);for(var i=0;i<hosts.length;i++){var host=hosts[i];var hostKey=host.id;var desc=host.desc;var linefeed=host.linefeed;// find list of referencing nodes\nvar nodeList=[];for(var j=0;j<nodes.length;j++){var node=nodes[j];console.log(\"node j=\"+j+hostKey+\" jhost\"+node.hostKey);if(node.hostKey===hostKey)nodeList.push(node.id);}var ipaddrs=this.props.ipaddrs;var ipAddrList=[];for(var k=0;k<host.ipAddrKeys.length;k++){var iKey=host.ipAddrKeys[k];ipAddrList.push(ipaddrs[iKey].ipAddr);}var nodeStr=nodeList.join();var addrStr=ipAddrList.join();var hostElem=this.makeRowElem(hostKey,[hostKey,desc,linefeed,nodeStr,addrStr]);hostElemList.push(hostElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:hostElemList})]});}},{key:\"makeShowNodes\",value:function makeShowNodes(){//console.log(\"makeShowNodes\");\nvar nodeElemList=[];var nodeObjs=this.props.nodes;var nodes=Object.keys(nodeObjs).map(function(key){return nodeObjs[key];});//  sort by nodeKey\nnodes=nodes.sort(function(a,b){return a.id>b.id?1:b.id>a.id?-1:0;});var nodeCols=[\"Node Name\",\"Description\",\"Address\",\"Host Name\",\"Config Files\"];var headElem=this.makeHeadElem(nodeCols);for(var i=0;i<nodes.length;i++){var node=nodes[i];var nodeKey=node.id;var desc=node.longName;;var nodeAddr=\"ipn:\"+node.ionNodeNum;var host=node.hostKey;var configStr=node.configKeys.join();var nodeElem=this.makeRowElem(nodeKey,[nodeKey,desc,nodeAddr,host,configStr]);nodeElemList.push(nodeElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:nodeElemList})]});}},{key:\"makeShowConfigs\",value:function makeShowConfigs(){//console.log(\"makeShowConfigs\");\nvar configElemList=[];var configObjs=this.props.configs;var configs=Object.keys(configObjs).map(function(key){return configObjs[key];});//  first, sort by nodeKey\nconfigs=configs.sort(function(a,b){return a.nodeKey>b.nodeKey?1:b.nodeKey>a.nodeKey?-1:0;});//  then, sort by configKey\nconfigs=configs.sort(function(a,b){return a.id>b.id?1:b.id>a.id?-1:0;});var configCols=[\"Config File\",\"Node/Graph Name\",\"Command Count\"];var headElem=this.makeHeadElem(configCols);for(var i=0;i<configs.length;i++){var config=configs[i];var configKey=config.id;var nodeKey=config.nodeKey;var cnt=config.cmdKeys.length;var configElem=this.makeRowElem(configKey,[configKey,nodeKey,cnt]);configElemList.push(configElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:configElemList})]});}},{key:\"makeShowCommands\",value:function makeShowCommands(){//console.log(\"makeShowCommands\");\nvar cmdElemList=[];var commandObjs=this.props.commands;var cmds=Object.keys(commandObjs).map(function(key){return commandObjs[key];});// first sort by configKey\ncmds=cmds.sort(function(a,b){return a.configKey>b.configKey?1:b.configKey>a.configKey?-1:0;});// then sort by typeKey\ncmds=cmds.sort(function(a,b){return a.typeKey>b.typeKey?1:b.typeKey>a.typeKey?-1:0;});var cmdCols=[\"Command Type\",\"Config File\",\"Last Update\",\"Warning(s)\",\"Command\"];var headElem=this.makeHeadElem(cmdCols);for(var i=0;i<cmds.length;i++){var cmdObj=cmds[i];var cmdKey=cmdObj.id;var type=cmdObj.typeKey;var file=cmdObj.configKey;var timeTag=cmdObj.lastUpdate;var cmdStr=this.makeCmdLine(type,cmdObj.values);var warns=\"\";if(cmdStr.indexOf(\"??\")>-1){warns+=\"missingParam\";}var cmdElem=this.makeRowElem(cmdKey,[type,file,timeTag,warns,cmdStr]);cmdElemList.push(cmdElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:cmdElemList})]});}},{key:\"makeShowSpans\",value:function makeShowSpans(){//console.log(\"makeShowSpans\");\nvar spanElemList=[];var spans=[];var cmdObjs=this.props.commands;for(var cmdKey in cmdObjs){if(cmdObjs[cmdKey].typeName.indexOf(\"span\")>=0)spans.push(cmdObjs[cmdKey]);}// first sort by configKey\nspans=spans.sort(function(a,b){return a.configKey>b.configKey?1:b.configKey>a.configKey?-1:0;});// then sort by typeKey\nspans=spans.sort(function(a,b){return a.typeName>b.typeName?1:b.typeName>a.typeName?-1:0;});var spanCols=[\"Command Type\",\"Config File\",\"Last Update\",\"Command\"];var headElem=this.makeHeadElem(spanCols);for(var i=0;i<spans.length;i++){var cmdObj=spans[i];var _cmdKey=cmdObj.id;var file=cmdObj.configKey;var type=cmdObj.typeName;var fullType=cmdObj.typeKey;var timeTag=cmdObj.lastUpdate;var cmdStr=this.makeCmdLine(fullType,cmdObj.values);var spanElem=this.makeRowElem(_cmdKey,[type,file,timeTag,cmdStr]);spanElemList.push(spanElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:spanElemList})]});}},{key:\"makeShowInducts\",value:function makeShowInducts(){//console.log(\"makeShowInducts\");\nvar inductElemList=[];var cVals=this.props.cloneValues;var cloneVals=Object.keys(cVals).map(function(key){return cVals[key];});// first sort by duct name (value)\ncloneVals=cloneVals.sort(function(a,b){return a.value>b.value?1:b.value>a.value?-1:0;});// then sort by type\ncloneVals=cloneVals.sort(function(a,b){return a.type>b.type?1:b.type>a.type?-1:0;});var inductCols=[\"Protocol\",\"Induct Name\",\"To Node\",\"Outducts From Node(s)\"];var headElem=this.makeHeadElem(inductCols);for(var cKey in cloneVals){var cloneObj=cloneVals[cKey];var type=cloneObj.type;var ductType=\"\";var idx=type.indexOf(\"Induct\");// an Induct Name clone value?\nif(idx>=0)ductType=type.substring(0,idx);else continue;var nodeKey=cloneObj.nodeKey;var ductName=cloneObj.value;console.log(\"inductName: \"+ductName);var clones=cloneObj.clones;var refList=[];for(var i=0;i<clones.length;i++){var clone=clones[i];var cmdKey=clone.cmdKey;var nKey=this.props.getNodeKey(cmdKey);refList.push(nKey);console.log(\"cmdKey: \"+cmdKey+\" nodeKey: \"+nKey);}var refs=JSON.stringify(refList);var inductElem=this.makeRowElem(cKey,[ductType,ductName,nodeKey,refs]);inductElemList.push(inductElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:inductElemList})]});}},{key:\"makeShowOutducts\",value:function makeShowOutducts(){//console.log(\"makeShowOutducts\");\nvar inductNodes={};// lookup for node destination\nvar outductElemList=[];var cVals=this.props.cloneValues;var clones=Object.keys(cVals).map(function(key){return cVals[key];});// first sort by duct name (value)\nclones=clones.sort(function(a,b){return a.value>b.value?1:b.value>a.value?-1:0;});// then sort by type\nclones=clones.sort(function(a,b){return a.type>b.type?1:b.type>a.type?-1:0;});// build lookup for induct names\nfor(var cKey in clones){var cloneObj=clones[cKey];var type=cloneObj.type;var idx=type.indexOf(\"Induct\");// an Induct Name clone value?\nif(idx>=0){var nodeKey=cloneObj.nodeKey;var ductName=cloneObj.value;inductNodes[ductName]=nodeKey;}}var outductCols=[\"Protocol\",\"Outduct Name\",\"From Node\",\"To Node\"];var headElem=this.makeHeadElem(outductCols);for(cKey in clones){var _cloneObj=clones[cKey];type=_cloneObj.type;var ductType=\"\";idx=type.indexOf(\"Outduct\");// an Induct Name clone value?\nif(idx>=0)ductType=type.substring(0,idx);else continue;var fromNode=_cloneObj.nodeKey;var _ductName=_cloneObj.value;var toNode=inductNodes[_ductName];var outductElem=this.makeRowElem(cKey,[ductType,_ductName,fromNode,toNode]);outductElemList.push(outductElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:outductElemList})]});}},{key:\"makeShowClones\",value:function makeShowClones(){console.log(\"makeShowClones\");var cloneElemList=[];var cmds=this.props.commands;// command objects\nvar cVals=this.props.cloneValues;// clone value objects\nvar cloneVals=Object.keys(cVals).map(function(key){return cVals[key];});// first sort by value to clone (value)\ncloneVals=cloneVals.sort(function(a,b){return a.value>b.value?1:b.value>a.value?-1:0;});// then sort by type\ncloneVals=cloneVals.sort(function(a,b){return a.type>b.type?1:b.type>a.type?-1:0;});var cloneCols=[\"Origin Type\",\"Origin Value\",\"Origin Node\",\"Target Config File\",\"Command with Cloned Value\"];var headElem=this.makeHeadElem(cloneCols);for(var cKey in cloneVals){var cloneObj=cloneVals[cKey];var type=cloneObj.type;var nodeKey=cloneObj.nodeKey;var value=cloneObj.value;//console.log(\"value: \" + value);\nvar clones=cloneObj.clones;for(var i=0;i<clones.length;i++){var elemKey=cKey+i;var clone=clones[i];var cmdKey=clone.cmdKey;//console.log(\"cmdKey: \" + cmdKey);\nvar cmdObj=cmds[cmdKey];var typeKey=cmdObj.typeKey;var params=cmdObj.values;var configKey=cmdObj.configKey;var cmdLine=this.makeCmdLine(typeKey,params);var cloneElem=this.makeRowElem(elemKey,[type,value,nodeKey,configKey,cmdLine]);cloneElemList.push(cloneElem);}}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:cloneElemList})]});}},{key:\"makeShowAlerts\",value:function makeShowAlerts(){console.log(\"makeShowAlerts\");var alertElemList=[];var alerts=this.checkModel();var alertCols=[\"Model Entity\",\"Name\",\"Level\",\"Alert Message\"];var headElem=this.makeHeadElem(alertCols);for(var i=0;i<alerts.length;i++){var alert=alerts[i];var entity=alert.type;var name=alert.name;var level=alert.level;var msg=alert.msg;var alertElem=this.makeRowElem(i,[entity,name,level,msg]);alertElemList.push(alertElem);}return/*#__PURE__*/_jsxs(Table,{striped:true,condensed:true,hover:true,children:[headElem,/*#__PURE__*/_jsx(\"tbody\",{children:alertElemList})]});}},{key:\"checkModel\",value:// check model for errors\nfunction checkModel(){var alerts=[];var modelName=this.props.name;var hosts=this.props.hosts;var nodes=this.props.nodes;var graphs=this.props.graphs;var configs=this.props.configs;var commands=this.props.commands;// Model-level\nif(Object.keys(graphs).length===0)alerts.push({\"type\":\"IonModel\",\"name\":modelName,\"level\":\"warn\",\"msg\":\"No graphs created.\"});if(Object.keys(nodes).length===0)alerts.push({\"type\":\"IonModel\",\"name\":modelName,\"level\":\"warn\",\"msg\":\"No nodes created.\"});// Node-level   required configs\nvar reqConfigs=[\"ionrc\",\"ionconfig\",\"ipnrc\"];// TODO : add req for bprc of either v6 or v7\n// Config-level required command types\nvar reqCmds={};reqCmds[\"ionrc\"]=[\"initialize\",\"start\"];reqCmds[\"bpv6rc\"]=[\"initialize\",\"scheme\",\"start\"];reqCmds[\"bpv7rc\"]=[\"initialize\",\"scheme\",\"start\"];reqCmds[\"ionconfig\"]=[];reqCmds[\"ipnrc\"]=[\"plan\"];reqCmds[\"ltprc\"]=[\"initialize\"];reqCmds[\"bssprc\"]=[\"initialize\"];// host loop\nfor(var hostKey in hosts){var host=hosts[hostKey];if(host.ipAddrKeys.length===0){var msg=\"has no IP addresses defined.\";alerts.push({\"type\":\"Host\",\"name\":hostKey,\"level\":\"warn\",\"msg\":msg});}}// node loop\nfor(var nodeKey in nodes){var node=nodes[nodeKey];if(node.hostKey===\"\"){var _msg=\"has no host machine assigned.\";alerts.push({\"type\":\"Node\",\"name\":nodeKey,\"level\":\"warn\",\"msg\":_msg});}var ionVerSeqNo=this.getIonVerSeqNo(nodeKey);var ionVer=versions[ionVerSeqNo].ionVersion;var protFlags={};// dict for protocol cmd existence\nvar ductFlags={};// dict for duct cmd existence by protocol\nconsole.log(\"checking commands for version seq: \"+ionVerSeqNo.toString());var nconfs=node.configKeys;for(var i=0;i<reqConfigs.length;i++){var chkConf=reqConfigs[i];var missing=true;for(var j=0;j<nconfs.length;j++){if(nconfs[j].indexOf(chkConf)>=0)missing=false;}if(missing){var _msg2=\"Has no \"+chkConf+\" file.\";alerts.push({\"type\":\"Node\",\"name\":nodeKey,\"level\":\"warn\",\"msg\":_msg2});}}console.log(\"+++ conf count: \"+nconfs.length);// node configs loop\nfor(var k=0;k<nconfs.length;k++){var confKey=nconfs[k];var configObj=configs[confKey];var _chkConf=configObj.configType;var cmdCounts={};// dict for cmd type counts\nvar missed=[];// assume all required commands missing...will drop from list if found\nif(reqCmds.hasOwnProperty(_chkConf))missed=reqCmds[_chkConf];console.log(\"+++ checking reqd cmds: \"+missed.toString());// node config commands loop\nfor(var n=0;n<configObj.cmdKeys.length;n++){var cmdKey=configObj.cmdKeys[n];var cmdTypeKey=commands[cmdKey].typeKey;var cmdType=cmdTypes[cmdTypeKey];console.log(\"checking command type: \"+cmdTypeKey+\" \");if(cmdType.verFrom>ionVerSeqNo){var _msg3=\"Node \"+nodeKey+\"(\"+ionVer+\") needs earlier variant of this command\";alerts.push({\"type\":\"Command\",\"name\":cmdTypeKey,\"level\":\"warn\",\"msg\":_msg3});}if(cmdType.verThru<ionVerSeqNo){var _msg4=\"Node \"+nodeKey+\"(\"+ionVer+\") needs later variant of this command\";alerts.push({\"type\":\"Command\",\"name\":cmdTypeKey,\"level\":\"warn\",\"msg\":_msg4});}// keep count of each cmdType\nif(cmdCounts.hasOwnProperty(cmdTypeKey))cmdCounts[cmdTypeKey]+=1;else cmdCounts[cmdTypeKey]=1;for(var c=0;c<missed.length;c++){var reqCmd=missed[c];if(cmdTypeKey.indexOf(reqCmd)>=0){missed.splice(c,1);// drop this one from missing list\nbreak;// and exit loop\n}}// check for missing command parameters\nvar cmdObj=commands[cmdKey];var cmdStr=this.makeCmdLine(cmdTypeKey,cmdObj.values);console.log(\"cmdStr: \"+cmdStr);if(cmdStr.indexOf(\"??\")>-1){var _msg5=\"Missing parameter(s).\";var cmdTag=nodeKey+\".\"+cmdTypeKey;alerts.push({\"type\":\"Command\",\"name\":cmdTag,\"level\":\"warn\",\"msg\":_msg5});}// check for missing protocol cmds\nif(cmdStr.indexOf(\"induct\")>-1||cmdStr.indexOf(\"outduct\")>-1){var pList=cmdStr.split(\" \").filter(Boolean);// get non-empty tokens\nvar _prot=pList[2];// 3rd token should be protocol\nductFlags[_prot]=1;// don't need full count\n}if(cmdStr.indexOf(\"protocol\")>-1){var _pList=cmdStr.split(\" \").filter(Boolean);// get non-empty tokens\nvar _prot2=_pList[2];// 3rd token should be protocol\nprotFlags[_prot2]=1;// don't need full count\n}}// end of command loop\n// check for incorrect command duplicates\nconsole.log(\"***** cmdCounts \"+JSON.stringify(cmdCounts));for(var cntKey in cmdCounts){if(cmdCounts[cntKey]>1){console.log(\"***** \"+cntKey+\" count =\"+cmdCounts[cntKey].toString());if(!cmdTypes[cntKey].hasOwnProperty(\"multiple\")){// singleton command?\nvar _msg6=\"Improper duplicate command: \"+cntKey;alerts.push({\"type\":\"Config\",\"name\":confKey,\"level\":\"warn\",\"msg\":_msg6});}}}// alert any missing commands\nfor(var m=0;m<missed.length;m++){var missedCmd=missed[m];var _msg7=\"Has no \"+missedCmd+\" command.\";alerts.push({\"type\":\"Config\",\"name\":confKey,\"level\":\"warn\",\"msg\":_msg7});}}//end of config loop\nconsole.log(\"***** ductFlags \"+JSON.stringify(ductFlags));console.log(\"***** protFlags \"+JSON.stringify(protFlags));// alert any missing protocol commands\nfor(var prot in ductFlags){if(!protFlags.hasOwnProperty(prot)){var _msg8=\"The bprc is missing the protocol \"+prot+\" command.\";alerts.push({\"type\":\"Node\",\"name\":nodeKey,\"level\":\"error\",\"msg\":_msg8});}}}// end of node loop\nreturn alerts;}},{key:\"makeSelectFormElem\",value:function makeSelectFormElem(val,handler,options){var form=/*#__PURE__*/_jsx(FormControl,{readOnly:!this.state.editMode,disabled:!this.state.editMode,bsSize:\"sm\",componentClass:\"select\",value:val,onChange:handler,children:options});return form;}// show current value with selection widget\n},{key:\"makeShowForm\",value:function makeShowForm(val){var form=/*#__PURE__*/_jsx(FormControl,{readOnly:\"true\",bsSize:\"sm\",type:\"text\",value:val});return form;}},{key:\"makeIonEditor\",value:function makeIonEditor(){//console.log(\">>makeModelElems \" + JSON.stringify(this.state));\nvar modelElems=[];var icon='remove';var head=/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{sm:4,children:/*#__PURE__*/_jsx(Label,{bsSize:\"lg\",bsStyle:\"default\",children:\"ION Model Editor\"})}),/*#__PURE__*/_jsx(Col,{sm:1,children:/*#__PURE__*/_jsx(Button,{bsSize:\"sm\",bsStyle:\"success\",onClick:this.noedit,children:/*#__PURE__*/_jsx(Glyphicon,{glyph:icon})})})]},\"head\");modelElems.push(head);var nameElem=this.makeModelElem(\"name\",\"text\",this.state.name,\"ION Model Name\",1,false,\"\");modelElems.push(nameElem);var descElem=this.makeModelElem(\"desc\",\"text\",this.state.desc,\"Description\",2,false,\"\");modelElems.push(descElem);var numElem=this.makeModelElem(\"nextNodeNum\",\"number\",this.state.nextNodeNum,\"Next Node Num\",1,false,\"(for new Node)\");modelElems.push(numElem);// build contactGraph selector\nvar contactFunc=this.handleIonChange.bind(null,\"currentContacts\");var graphs=this.props.graphs;var opts=[];for(var name in graphs){var graph=graphs[name];var option=name;// get the first & only key\nvar text=graph[\"desc\"];opts.push(/*#__PURE__*/_jsxs(\"option\",{value:option,children:[option,\"    == \",text]},option));};opts.unshift(/*#__PURE__*/_jsx(\"option\",{value:\"none\",children:\"(Select)\"},\"none\"));console.log(\"graph options:\");var contacts=this.state.currentContacts;var show=this.makeShowForm(contacts);var form=this.makeSelectFormElem(contacts,contactFunc,opts);var contElem=/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{className:\"text-right\",sm:2,children:/*#__PURE__*/_jsx(\"b\",{children:\"Current Contacts Name\"})}),/*#__PURE__*/_jsx(Col,{sm:1,value:contacts,children:show}),/*#__PURE__*/_jsx(Col,{sm:2,type:\"select\",value:contacts,readOnly:\"false\",children:form}),/*#__PURE__*/_jsx(Col,{sm:2})]},\"contacts\");modelElems.push(contElem);return/*#__PURE__*/_jsx(\"div\",{children:modelElems});}},{key:\"makeIonViewer\",value:function makeIonViewer(){//console.log(\">>makeModelElems \" + JSON.stringify(this.state));\nvar modelElems=[];var head=/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{sm:2,children:[\" \",/*#__PURE__*/_jsx(Label,{bsSize:\"lg\",bsStyle:\"default\",children:\"ION Model Viewer\"})]})},\"head\");modelElems.push(head);var nameElem=this.makeModelElem(\"name\",\"text\",this.state.name,\"ION Model Name\",1,true,\"\");modelElems.push(nameElem);var descElem=this.makeModelElem(\"desc\",\"text\",this.state.desc,\"Description\",2,true,\"\");modelElems.push(descElem);var numElem=this.makeModelElem(\"nextNodeNum\",\"text\",this.state.nextNodeNum,\"Next Node Num\",1,true,\"\");modelElems.push(numElem);var contactsElem=this.makeModelElem(\"currentContacts\",\"text\",this.state.currentContacts,\"Current Contacts Graph\",1,true,\"\");modelElems.push(contactsElem);return/*#__PURE__*/_jsx(\"div\",{children:modelElems});}},{key:\"makeModelElem\",value:function makeModelElem(prop,type,val,label,size,read,note){//console.log(\">>MakeModelElem \" + prop + ' ' + type + ' ' + val + ' ' + size);\nvar form=/*#__PURE__*/_jsx(FormControl,{readOnly:read,bsSize:\"sm\",type:type,value:val,onChange:this.handleIonChange.bind(null,prop)});return/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{className:\"text-right\",sm:2,children:/*#__PURE__*/_jsx(\"b\",{children:label})}),/*#__PURE__*/_jsx(Col,{sm:size,value:val,children:form}),/*#__PURE__*/_jsx(Col,{sm:2,value:2,children:note})]},label);}},{key:\"makeSurveyElem\",value:function makeSurveyElem(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{sm:1}),/*#__PURE__*/_jsx(Col,{className:\"text-left\",sm:2,children:/*#__PURE__*/_jsx(\"b\",{children:\"Click Popout Survey Topic(s):\"})}),/*#__PURE__*/_jsx(Col,{sm:6,children:/*#__PURE__*/_jsxs(ButtonToolbar,{children:[/*#__PURE__*/_jsx(SurveyPopout,{label:\"Hosts\",showSurvey:this.makeShowHosts.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Nodes\",showSurvey:this.makeShowNodes.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Configs\",showSurvey:this.makeShowConfigs.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Commands\",showSurvey:this.makeShowCommands.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Endpoints\",showSurvey:this.makeShowEndpoints.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Inducts\",showSurvey:this.makeShowInducts.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Outducts\",showSurvey:this.makeShowOutducts.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Spans\",showSurvey:this.makeShowSpans.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Clones\",showSurvey:this.makeShowClones.bind(this)}),/*#__PURE__*/_jsx(SurveyPopout,{label:\"Alerts\",showSurvey:this.makeShowAlerts.bind(this)})]})})]})]});}},{key:\"render\",value:function render(){//console.log(\"IonModel render begin. state\" +JSON.stringify(this.state));\nconsole.log(\"IonModel render begin.\");var name=this.state.name;var editMode=this.state.editMode;var viewMode=this.state.viewMode;var surveyMode=this.state.surveyMode;var showPopoutMode=this.state.showPopoutMode;var expandMode=this.state.expandMode;var ionHosts=expandMode?this.makeHostListElem(name):\"\";var ionNodeList=expandMode?this.makeIonNodeListElem(name):\"\";var graphList=expandMode?this.makeGraphListElem(name):\"\";var showSurveyTag=surveyMode?\"Hide Surveys\":\"Show Surveys\";var offerSurveys=surveyMode?this.makeSurveyElem():\"\";var showPopoutWin=showPopoutMode?this.makeShowPopout():\"\";var editLabel=editMode?'Submit':'Edit';var viewLabel=viewMode?'Hide':'Show';var expandIcon=expandMode?'chevron-down':'chevron-right';var dimSaveION=false;var dimSaveConfigs=false;var alerts=this.checkModel();// any alerts?\nvar alertit=alerts.length?/*#__PURE__*/_jsx(Alert,{bsStyle:\"danger\",children:/*#__PURE__*/_jsx(\"b\",{children:\"See Alerts (in Surveys)\"})}):\"\";var viewPanel=null;if(viewMode)if(editMode)viewPanel=this.makeIonEditor();else viewPanel=this.makeIonViewer();console.log(\"IonModel render return next.\");return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{className:\"text-left\",sm:1,children:/*#__PURE__*/_jsx(Label,{bsSize:\"sm\",bsStyle:\"default\",children:\"ION Model\"})}),/*#__PURE__*/_jsx(Col,{className:\"text-right\",sm:1,children:/*#__PURE__*/_jsx(\"b\",{children:name})}),/*#__PURE__*/_jsx(Col,{className:\"text-left\",sm:2,children:this.state.desc}),/*#__PURE__*/_jsx(Col,{sm:6,children:/*#__PURE__*/_jsxs(ButtonToolbar,{children:[/*#__PURE__*/_jsx(Button,{bsSize:\"sm\",bsStyle:\"primary\",onClick:this.edit,children:editLabel}),/*#__PURE__*/_jsx(Button,{bsSize:\"sm\",bsStyle:\"info\",onClick:this.view,children:viewLabel}),/*#__PURE__*/_jsx(Button,{bsSize:\"sm\",bsStyle:\"info\",onClick:this.showSurveys,children:showSurveyTag}),/*#__PURE__*/_jsx(Button,{bsSize:\"sm\",bsStyle:\"primary\",disabled:dimSaveION,onClick:this.saveModel,children:\"Save Model\"}),/*#__PURE__*/_jsx(Button,{bsSize:\"sm\",bsStyle:\"primary\",disabled:dimSaveConfigs,onClick:this.saveConfigs,children:\"Save Configs\"}),/*#__PURE__*/_jsxs(Button,{bsSize:\"sm\",bsStyle:\"success\",onClick:this.expand,children:[/*#__PURE__*/_jsx(Glyphicon,{glyph:expandIcon}),' ']})]})}),/*#__PURE__*/_jsxs(Col,{sm:2,children:[\" \",alertit,\" \"]})]}),offerSurveys,showPopoutWin,/*#__PURE__*/_jsx(Panel,{collapsible:true,expanded:viewMode,children:viewPanel}),/*#__PURE__*/_jsxs(Panel,{collapsible:true,expanded:expandMode,children:[ionHosts,ionNodeList,graphList]})]});}}]);return IonModel;}(React.Component);export{IonModel as default};","map":{"version":3,"names":["React","FormControl","Row","Col","Label","Button","ButtonToolbar","Table","Panel","Glyphicon","PopoutWindow","saveAs","JSZip","Alert","SurveyPopout","Config","Command","HostList","IonNodeList","GraphList","cmdTypes","configTypes","paramTypes","patterns","selections","versions","IonModel","props","expand","newState","Object","assign","state","expandMode","console","log","setState","edit","editMode","submit","viewMode","noedit","JSON","stringify","desc","ionModel","name","nextNodeNum","currentContacts","tran","action","dispatch","view","showSurveys","newMode","surveyMode","showPopout","showPopoutMode","myPopout","window","open","close","saveModel","modelObj","makeModelObj","modelJson","blob","Blob","type","modelName","saveConfigs","zip","rootdir","folder","graphKey","graphLines","makeCmdLines","nodeKey","nodes","node","nodedir","id","confKeys","configKeys","lf","host","hosts","hostKey","linefeed","j","length","configKey","cmdLines","page","join","file","graphPage","startName","makeStartLines","zipname","generateAsync","then","content","handleIonChange","prop","e","target","value","preventDefault","newProps","ipaddrs","graphs","configs","model","hostObj","hostJson","hostName","hostDesc","ipAddrs","addrKey","push","ipAddr","nodeObj","nodeJson","nodeName","nodeDesc","longName","nodeNum","ionNodeNum","ionVersion","nodeConfigKeys","i","configObj","configType","configJson","makeConfigObj","ctxKey","ctxObj","graphsJson","graphName","graphDesc","commands","config","configCmdKeys","cmdKeys","cmdId","cmdObj","userCmdObj","typeKey","lastUpdate","parameters","values","msg","hasOwnProperty","ver","graph","seqno","paramTypeKey","paramType","optional","isGoodName","makeOptElems","makeOptionElems","contacts","isGoodNodeNum","bind","makeStarts","makeTypeOptions","makeConfigElem","makeCommandElem","makeParamProps","pTypeKey","pIdx","paramVal","padit","w","str","pad","pType","longname","position","posTag","units","descrip","sels","undefined","select","keys","note","cmdTypeKey","cmdParams","targets","cmdPattern","cmdType","isOptional","replace","configTypeKey","configTypeObj","modelDesc","nodeLabel","program","now","Date","fileDate","format","cmdKey","cmd","cmdName","toUpperCase","pTypeKeys","cmdVals","val","makeParamNote","makeCmdLine","fileName","nodeConfigs","order","start_order","nodeConfig","indexOf","sort","a","b","prog","contactsFile","nodeId","cmdsList","verSeqNo","getIonVerSeqNo","toString","getVer","paramPropsList","pattern","vals","getValues","slice","clones","cloneValues","makeCmd","getVals","usedNodeKey","makeTypeOpts","getOptText","getOptionText","makePNote","def","defaultValue","copyClone","pickClone","showDefault","valType","cols","colElems","map","idx","headElem","rowKey","data","dataElems","rowElem","report","makeShowNodes","outerHeight","outerWidth","epElemList","cmds","commandObjs","typeName","Number","epCols","makeHeadElem","serviceNum","dispCode","disp","qTask","epElem","makeRowElem","hostElemList","hostObjs","nodeObjs","key","hostCols","nodeList","ipAddrList","k","ipAddrKeys","iKey","nodeStr","addrStr","hostElem","nodeElemList","nodeCols","nodeAddr","configStr","nodeElem","configElemList","configObjs","configCols","cnt","configElem","cmdElemList","cmdCols","timeTag","cmdStr","warns","cmdElem","spanElemList","spans","cmdObjs","spanCols","fullType","spanElem","inductElemList","cVals","cloneVals","inductCols","cKey","cloneObj","ductType","substring","ductName","refList","clone","nKey","getNodeKey","refs","inductElem","inductNodes","outductElemList","outductCols","fromNode","toNode","outductElem","cloneElemList","cloneCols","elemKey","params","cmdLine","cloneElem","alertElemList","alerts","checkModel","alertCols","alert","entity","level","alertElem","reqConfigs","reqCmds","ionVerSeqNo","ionVer","protFlags","ductFlags","nconfs","chkConf","missing","confKey","cmdCounts","missed","n","verFrom","verThru","c","reqCmd","splice","cmdTag","pList","split","filter","Boolean","prot","cntKey","m","missedCmd","handler","options","form","modelElems","icon","head","nameElem","makeModelElem","descElem","numElem","contactFunc","opts","option","text","unshift","show","makeShowForm","makeSelectFormElem","contElem","contactsElem","label","size","read","makeShowHosts","makeShowConfigs","makeShowCommands","makeShowEndpoints","makeShowInducts","makeShowOutducts","makeShowSpans","makeShowClones","makeShowAlerts","ionHosts","makeHostListElem","ionNodeList","makeIonNodeListElem","graphList","makeGraphListElem","showSurveyTag","offerSurveys","makeSurveyElem","showPopoutWin","makeShowPopout","editLabel","viewLabel","expandIcon","dimSaveION","dimSaveConfigs","alertit","viewPanel","makeIonEditor","makeIonViewer","Component"],"sources":["/Users/rlborgen/git/ionconfig/editor/src/IonModel.jsx"],"sourcesContent":["//        IonModel.jsx     IonModel React Component\n//\n//        Copyright (c) 2018, California Institute of Technology.\n//        ALL RIGHTS RESERVED.  U.S. Government Sponsorship\n//        acknowledged.\n//                                                                   \n//      Author: Rick Borgen, Jet Propulsion Laboratory         \n//                                                               \nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport {FormControl} from 'react-bootstrap';\nimport {Row,Col} from 'react-bootstrap';\nimport {Label,Button,ButtonToolbar} from 'react-bootstrap';\nimport {Table, Panel} from 'react-bootstrap';\nimport {Glyphicon} from 'react-bootstrap';\nimport PopoutWindow from 'react-popout';\nimport {saveAs} from \"file-saver\";\nimport JSZip from \"jszip\";\nimport {Alert} from 'react-bootstrap';\n\nimport SurveyPopout from './SurveyPopout.jsx';\nimport Config       from './Config.jsx';\nimport Command      from './Command.jsx';\nimport HostList     from './HostList.jsx';\nimport IonNodeList  from './IonNodeList.jsx';\nimport GraphList    from './GraphList.jsx';\n\nimport cmdTypes     from './cmdTypes.json';\nimport configTypes  from './configTypes.json';\nimport paramTypes   from './paramTypes.json';\nimport patterns     from './patterns.json';\nimport selections   from './selections.json';\nimport versions     from './ionVersions.json';\n\nexport default class IonModel  extends React.Component {\n  constructor (props) {\n    super(props);\n    // props\n    //  name\n    console.log(\"IonModel ctor\");\n    this.state = {\n      name: this.props.name,\n      desc: this.props.desc,\n      nextNodeNum: this.props.nextNodeNum,\n      currentContacts: this.props.currentContacts,\n\n      editMode: false,\n      viewMode: false,\n      surveyMode: false,\n      showPopoutMode: false,\n      expandMode: false\n    }\n  };\n  componentWillReceiveProps(newProps) {\n    //console.log(\"IonModel componentWillReceiveProps\" + newProps.desc + ' ' + newProps.nextNodeNum);\n    if (newProps.nextNodeNum !== this.state.nextNodeNum) {\n       var newState = Object.assign({},this.state);\n       newState.nextNodeNum = newProps.nextNodeNum;   // only field updated externally\n       this.setState (newState);\n    }\n    return null;\n  }\n  makeModelObj() {\n    console.log(\"makeUserModel net:\" + this.state.name);\n    const hosts = this.props.hosts;\n    const ipaddrs = this.props.ipaddrs;\n    const graphs = this.props.graphs;\n    const nodes = this.props.nodes;\n    const configs = this.props.configs;\n    var model = {};    // user model built from current state\n\n    model[\"ionModelName\"] = this.state.name;\n    model[\"ionModelDesc\"] = this.state.desc;\n    model[\"nextNodeNum\"] = this.state.nextNodeNum;\n    model[\"currentContacts\"] = this.state.currentContacts;\n    model[\"hosts\"] = [];\n    model[\"nodes\"] = [];\n    model[\"graphs\"]  = [];\n\n    for (var hostKey in hosts) {\n      const hostObj = hosts[hostKey];\n      var hostJson = {\n        hostName: hostKey,\n        hostDesc: hostObj.desc,\n        linefeed: hostObj.linefeed,\n        ipAddrs: []\n      }\n      for (var addrKey in ipaddrs) {\n        if (ipaddrs[addrKey].hostKey === hostKey)\n          hostJson[\"ipAddrs\"].push(ipaddrs[addrKey].ipAddr)\n      }\n      model[\"hosts\"].push(hostJson);\n    }\n    for (var nodeKey in nodes) {\n      const nodeObj = nodes[nodeKey];\n      var nodeJson = {\n        nodeName: nodeKey,\n        nodeDesc: nodeObj.longName,\n        nodeNum: nodeObj.ionNodeNum,\n        ionVersion: nodeObj.ionVersion,\n        hostName: nodeObj.hostKey,\n        configs: {}\n      }\n      const nodeConfigKeys = nodeObj.configKeys;\n      for (var i=0; i<nodeConfigKeys.length; i++) {\n        const configKey = nodeConfigKeys[i];\n        const configObj = configs[configKey];\n        const configType = configObj.configType;\n        let configJson = this.makeConfigObj(configKey);\n        nodeJson.configs[configType] =  configJson;\n      }\n      model[\"nodes\"].push(nodeJson);\n    }\n    for (var ctxKey in graphs) {\n      const ctxObj = graphs[ctxKey];\n      var graphsJson = {\n        graphName: ctxKey,\n        graphDesc: ctxObj.desc,\n        ionVersion: ctxObj.ionVersion,\n        configs: {}\n      }\n      const configKey = ctxObj.configKey;  // just one config\n      console.log(\"graph configKey: \" + configKey);\n      const configObj = configs[configKey];\n      const configType = configObj.configType;\n      let configJson = this.makeConfigObj(configKey);\n      graphsJson.configs[configType] =  configJson;\n      model[\"graphs\"].push(graphsJson);\n    }\n    return model;\n  };\n  makeConfigObj(configKey) {\n    const configs = this.props.configs;\n    const commands = this.props.commands;\n    var config = { commands: [] };\n\n    const configObj = configs[configKey];\n    const configCmdKeys = configObj.cmdKeys;\n    for (var j=0; j<configCmdKeys.length; j++) {\n      const cmdId = configCmdKeys[j];\n      console.log(\"cmdId: \" + cmdId);\n      const cmdObj = commands[cmdId];    \n      const userCmdObj = {\n        type: cmdObj.typeKey,\n        lastUpdate: cmdObj.lastUpdate,\n        parameters: cmdObj.values\n      };\n      config.commands.push(userCmdObj);\n    }\n    return config;\n  };\n  makeAlertElem(msg) {\n    return (<Alert bsStyle=\"danger\"><b>ERROR: {msg}</b></Alert>);\n  };\n  // tranlsate version to sequence number for command effectivity\n  getIonVerSeqNo(nodeKey) {\n    console.log(\"getIonVerSeqNo for:\" + nodeKey);\n    const nodes = this.props.nodes;\n    const graphs = this.props.graphs;\n    if (!(nodes.hasOwnProperty(nodeKey) || graphs.hasOwnProperty(nodeKey) ) )\n      return 0;\n    var ver = 0;\n    if (nodeKey in nodes) {\n      const node = nodes[nodeKey];\n      console.log(\"??? node: \" + JSON.stringify(node));\n      ver = node.ionVersion;\n    } else {\n      const graph = graphs[nodeKey];\n      console.log(\"??? graph: \" + JSON.stringify(graph));\n      ver = graph.ionVersion;\n    }\n    console.log(\"???nodeKey: \" + nodeKey + \" ionVer: \"+ ver);\n    for (var seqno in versions) {\n      if (ver === versions[seqno].ionVersion)\n        return seqno;\n    }\n    return 0;                       \n  };\n  isOptional(paramTypeKey) {\n    const paramType = paramTypes[paramTypeKey];\n    return paramType.optional;\n  };\n  makeHostListElem(name) {\n    console.log(\"makeHostListElem\");\n    const hosts = this.props.hosts;                   // host objects\n    const ipaddrs = this.props.ipaddrs;               // ipaddr objects\n    const isGoodName = this.props.isGoodName;         // pass through\n    const makeOptElems = this.props.makeOptionElems;  // pass through\n    const dispatch = this.props.dispatch;             // pass through\n    return (\n      <HostList\n        key=\"1\"                        // unique id\n        name={name}                    // user model - defaults to model name\n        hosts={hosts}                  // user model - hosts\n        ipaddrs={ipaddrs}              // user model - ipaddrs\n\n        isGoodName={isGoodName}        // verify name string is valid\n        makeOptionElems={makeOptElems} // static options building func\n\n        dispatch={dispatch}            // dispatch func for new hosts/ipaddrs\n      />\n    );  \n  }\n  makeIonNodeListElem(name) {\n    console.log(\"makeIonNodeListElem\");\n    const contacts = this.props.currentContacts;        // network contacts name\n    const nodes = this.props.nodes;                     // node objects\n    const hosts = this.props.hosts;                     // host objects\n    const configs = this.props.configs;                 // config objects\n    const commands = this.props.commands;               // command objects\n    const ipaddrs = this.props.ipaddrs;                 // ipaddr objects\n    const isGoodName = this.props.isGoodName;           // pass through\n    const isGoodNodeNum = this.props.isGoodNodeNum;     // pass through\n    const makeCmdLines = this.makeCmdLines.bind(this);         // remember this\n    const makeStarts = this.makeStartLines.bind(this);         // remember this\n    const makeTypeOptions = this.props.makeTypeOptions;        // pass through\n    const makeOptElems = this.props.makeOptionElems;           // pass through\n    const makeConfigElem = this.makeConfigElem.bind(this);     // remember this\n    const makeCommandElem = this.makeCommandElem.bind(this);   // remember this\n    const makeParamProps = this.makeParamProps.bind(this);     // remember this\n    const dispatch = this.props.dispatch;                      // pass through\n    return (\n      <IonNodeList\n        key=\"2\"                            // unique id\n        name={name}                        // user model - defaults to model name\n        currentContacts={contacts}         // user model - network contacts name\n        nodes={nodes}                      // user model - nodes\n        hosts={hosts}                      // user model - hosts\n        configs={configs}                  // user model - configs\n        commands={commands}                // user model - commands\n        ipaddrs={ipaddrs}                  // user model - ipaddrs\n\n        configTypes={configTypes}          // schema\n        cmdTypes={cmdTypes}                // schema\n        paramTypes={paramTypes}            // schema\n\n        isGoodName={isGoodName}             // verify name string is valid\n        isGoodNodeNum={isGoodNodeNum}       // verify name string is valid\n        makeCmdLines={makeCmdLines}         // all lines formatting of config file\n        makeStartLines={makeStarts}         // all lines for a start script\n        makeTypeOptions={makeTypeOptions}   // get dynamic (cloned) options\n        makeOptionElems={makeOptElems}      // static options building func\n        makeConfigElem={makeConfigElem}     // build config elem\n        makeCommandElem={makeCommandElem}   // build command elem\n        makeParamProps={makeParamProps}     // build param props\n\n        dispatch={dispatch}                 // dispatch func for new hosts/ipaddrs\n      />  \n    );  \n  }\n  makeGraphListElem(name) {\n    console.log(\"makeGraphListElem\");\n    const graphs = this.props.graphs;                       // graph objects\n    const configs = this.props.configs;                     // config objects\n    const commands = this.props.commands;                   // command objects\n    const isGoodName = this.props.isGoodName;               // pass through\n    const makeCmdLines = this.makeCmdLines.bind(this);      // remember this\n    const makeTypeOptions = this.props.makeTypeOptions;     // pass through\n    const makeOptElems = this.props.makeOptionElems;        // pass through\n    const makeConfigElem = this.makeConfigElem.bind(this);  // remember this\n    const makeCommandElem = this.makeCommandElem.bind(this);// remember this\n    const makeParamProps = this.makeParamProps.bind(this);  // remember this\n    const dispatch = this.props.dispatch;                   // pass through\n    return (\n      <GraphList\n        key=\"3\"                             // unique id\n        name={name}                         // user model - defaults to model name\n        graphs={graphs}                     // user model - graphs\n        configs={configs}                   // user model - configs\n        commands={commands}                 // user model - commands\n\n        isGoodName={isGoodName}             // verify name string is valid\n        makeCmdLines={makeCmdLines}         // all lines formatting of config file\n        makeTypeOptions={makeTypeOptions}   // get dynamic (cloned) options\n        makeOptionElems={makeOptElems}      // static options building func\n        makeConfigElem={makeConfigElem}     // build config elem\n        makeCommandElem={makeCommandElem}   // build command elem\n        makeParamProps={makeParamProps}     // build param props\n\n        dispatch={dispatch}                 // dispatch func for new graphs\n      />  \n    );  \n  }\n  // build ION parameter annotation (commands file format)\n  makeParamNote(pTypeKey,pIdx,paramVal) {\n    // define padit here, because \"this\" can be weird\n    function padit (w,str,pad) {\n      return (w <= str.length) ? str : padit(w, pad + str, pad);\n    };\n    //console.log(\"makeParamNote: \" + pTypeKey + \" \" + pIdx + \" \" + paramVal);\n    var pType = paramTypes[pTypeKey];\n    var longname = pType.name;\n    longname = padit(34,longname,\" \");\n    const position = pIdx + 1;\n    const posTag = \"[\"+ position + \"]\";\n    var units = \"\";\n    if (pType.units !== \"\") {\n      units = \"(\" + pType.units + \")\";\n    }\n    var descrip = \"\";\n    var sels = undefined;\n    if (pTypeKey in selections) {\n      sels = selections[pTypeKey];\n    }\n    if (sels) {\n      //console.log(\"makeParamNote sels: \" + JSON.stringify(sels));\n      for (var i = 0; i < sels.length; i++) {\n        var select = sels[i];\n        if(Object.keys(select)[0] === paramVal) {\n          descrip = \"[\" + select[paramVal] + \"]\";\n        }\n      }\n    }\n    const note = \"#  \" + posTag + \" \" + longname + \" : \" + paramVal + \" \" + units + \" \" + descrip;\n    //console.log(\"param Note \" + pTypeKey + \" \" + note);\n    return note;\n  }\n  // builds ION command text (commands file format)\n  makeCmdLine(cmdTypeKey,cmdParams) {\n    // console.log(\"makeCmdLine cmdTypeKey: \" + cmdTypeKey + \"  Params : \" + JSON.stringify(cmdParams));\n    const targets = [ \"[1]\", \"[2]\", \"[3]\", \"[4]\", \"[5]\", \"[6]\", \"[7]\", \"[8]\", \"[9]\" ];\n    var cmdPattern = patterns[cmdTypeKey];\n    let cmdType = cmdTypes[cmdTypeKey];\n    //console.log(\"cmdType: \" + JSON.stringify(cmdType));\n    for (var i = 0; i < cmdParams.length; i++) {\n      //console.log(\"makeCmdLine Pattern: \" + cmdPattern + \" tgt: \" + cmdTypeKey + \"  \" + targets[i] + \"  \" + cmdParams[i]);\n      var paramTypeKey = cmdType.paramTypes[i];\n      if (cmdParams[i] === \"\")\n        if (this.isOptional(paramTypeKey))\n          cmdPattern = cmdPattern.replace(targets[i],\"\");\n        else\n          cmdPattern = cmdPattern.replace(targets[i],\"??\");\n      else\n        cmdPattern = cmdPattern.replace(targets[i],cmdParams[i]);\n    }\n    //console.log(\"cmd Type pattern \" + cmdTypeKey + \" \" + cmd);\n    return cmdPattern;\n  }\n  makeCmdLines(configKey) {\n    console.log(\"makeCmdLines for: \" + configKey);\n    const configObj = this.props.configs[configKey];\n    const cmdKeys = configObj.cmdKeys;\n    const configTypeKey = configObj.configType;\n    const configTypeObj = configTypes[configTypeKey];\n    //console.log(\"makeConfigElem configType:\" + JSON.stringify(configType));\n    const modelName = this.state.name;\n    const modelDesc = this.state.desc;\n    const nodeKey = configObj.nodeKey;\n    const node = this.props.nodes[nodeKey];\n    let nodeDesc = \"\";\n    let nodeLabel = \"\";\n    if (node) {  // a node?,  might be a graphs key)    \n      nodeDesc = this.props.nodes[nodeKey].longName; \n      nodeLabel = \"ipn:\" + node.ionNodeNum;\n    };\n    const content = configTypeObj.content;\n    const program = configTypeObj.program;\n    const commands = this.props.commands;\n\n    const now = new Date();\n    const fileDate = now.format(\"YYYY-MM-DD hh:mm\");\n    var cmdLines = [];\n    // build header \n    cmdLines.push(\"#  FILE:      \" + configObj.id);\n    //console.log(\"makeCmdLines commands: \" + Object.keys(this.props.commands).length); \n    cmdLines.push(\"#  CONTENT:   \" + content);\n    cmdLines.push(\"#  FOR:       \" + program);\n    cmdLines.push(\"#  BUILDER:   ION Configuration Editor\");\n    cmdLines.push(\"#  NETWORK:   \" + modelName + \"    [\" + modelDesc + \"]\");\n    if (node) {\n      cmdLines.push(\"#  NODE:      \" + nodeKey +  \"    [\" + nodeDesc + \"]\");\n      cmdLines.push(\"#  IPN:       \" + nodeLabel);\n    }\n    cmdLines.push(\"#  DATE:      \" + fileDate);\n    // build commands\n    for (var i=0; i<cmdKeys.length; i++) {\n      const cmdKey = cmdKeys[i];\n      //console.log(\"makeCmdLines i: \" + i + \" cmdKey: \" + cmdKey);\n      const cmd = commands[cmdKey];\n      const cmdTypeKey = cmd.typeKey;\n      //console.log(\"makeCmdLines cmdTypeKey: \" + cmdTypeKey);\n      const cmdType = cmdTypes[cmdTypeKey];\n      const cmdName = cmdType.name;\n      cmdLines.push(\"#\");\n      cmdLines.push(\"#  \" + cmdName.toUpperCase());\n      const pTypeKeys = cmdType.paramTypes;\n      const cmdVals = cmd.values;\n      for (let j=0; j<pTypeKeys.length; j++) {\n        const pTypeKey = pTypeKeys[j];\n        const val = cmdVals[j];\n        cmdLines.push(this.makeParamNote(pTypeKey,j,val));\n      }\n      cmdLines.push(this.makeCmdLine(cmdTypeKey,cmdVals));\n    }\n    return cmdLines;\n  }\n  // build the start script text lines for a node\n  makeStartLines(nodeKey) {\n    let node = this.props.nodes[nodeKey];\n    let fileName = \"start_\" + nodeKey + \".sh\";\n    let nodeLabel = \"ipn:\" + node.ionNodeNum;\n    const now = new Date();\n    const fileDate = now.format(\"YYYY-MM-DD hh:mm\");\n    var cmdLines = [];\n    cmdLines.push(\"#!/bin/bash\");\n    cmdLines.push(\"#  FILE:  \" + fileName);\n    cmdLines.push(\"#  NODE:  \" + nodeKey + \" [\" + nodeLabel + \"]\");\n    cmdLines.push(\"#  DESC:  \" + node.longName);\n    cmdLines.push(\"#  DATE:  \" + fileDate);\n    cmdLines.push(\"host=`uname -n`\");\n    cmdLines.push(\"wdir=`pwd`\");\n    cmdLines.push('echo \"Clearing old ion.log\"');\n    cmdLines.push(\"echo > ion.log\");\n\n    let nodeConfigs = [];\n    let configs = this.props.configs;\n    for (var i=0; i<node.configKeys.length; i++) {\n      let configKey = node.configKeys[i];\n      let configType = configs[configKey].configType;\n      let order = configTypes[configType].start_order;\n      let nodeConfig = configs[configKey];\n      nodeConfig.order = order;\n      if (configKey.indexOf(\"ionconfig\") < 0)  // add all except ionconfig\n         nodeConfigs.push(nodeConfig);\n    }\n    nodeConfigs.sort( (a,b) => (a.order > b.order) ? 1 : -1);\n    console.log(\"makeStartLines sortConfigs: \" + JSON.stringify(nodeConfigs));\n    for (var j=0; j<nodeConfigs.length; j++) {\n      let configObj = nodeConfigs[j];\n      let configKey = configObj.id;\n      console.log(\"makeStartLines configKey: \" + configKey);\n      let configTypeKey = configObj.configType;\n      let configTypeObj = configTypes[configTypeKey];\n      let prog = configTypeObj.program;\n      if (j === 0) \n        cmdLines.push('echo \"Starting ION node ' + nodeLabel + ' on $host from $wdir\"');\n      else\n        cmdLines.push(\"sleep  1\");\n      cmdLines.push(prog + \"  \" + configKey);\n    }\n    // special case for (global) graphs file\n    let contacts = this.state.currentContacts;\n    if (contacts !== \"\") {\n      let contactsFile = contacts + \".cg\";\n      cmdLines.push(\"sleep  1\");\n      cmdLines.push(\"# global contact graph\");\n      cmdLines.push(\"ionadmin  \" + contactsFile);\n    }\n    let nodeId = node.ionNodeNum;\n    cmdLines.push('echo \"Startup of ION node ' + nodeLabel + ' on $host complete!\"');\n    cmdLines.push('echo \"Starting bpecho on ipn:' + nodeId + '.3.\"');\n    cmdLines.push('bpecho   ipn:' + nodeId + '.3 &');\n    return cmdLines;\n  }\n  // build and return a Config file element\n  makeConfigElem(configKey,cmdKeys,cmdsList) {\n    const config = this.props.configs[configKey];\n    const configTypeKey = config.configType;\n    const configType = configTypes[configTypeKey];\n    const nodeKey = config.nodeKey;     // note...nodeKey might NOT be a node (graphs)\n    var verSeqNo = this.getIonVerSeqNo(nodeKey);\n    console.log(\"???the Version sequence Number is: \" + verSeqNo.toString() + \" for \" + configKey);\n    const nodes = this.props.nodes;\n    var host = null;\n    if (nodes.hasOwnProperty(nodeKey)) {\n      const hostKey = nodes[nodeKey].hostKey;\n      host = this.props.hosts[hostKey];\n    }\n\n    const makeCmdLines = this.makeCmdLines.bind(this);\n    const getVer = this.getIonVerSeqNo.bind(this);\n    const dispatch = this.props.dispatch;    // make sure dispatch remembers \"this\"\n\n    return (\n      <Config\n        key={configKey}                 // unique id\n        name={config.id}                // unique name of this config file\n        configType={configType}         // schema - config type object\n        nodeKey={nodeKey}               // user model - node key\n        host={host}                     // user model - host object\n        cmdKeys={cmdKeys}               // list of command keys  for this config file\n\n        makeCmdLines={makeCmdLines}     // all lines formatting of config file\n        getIonVerSeqNo={getVer}         // get version seq num\n        dispatch={dispatch}             // dispatch func for new commands\n \n        children={cmdsList}             // list of command elements for this config file\n      />\n    );  \n  }\n  // build and return a Command element\n  makeCommandElem(nodeKey,configKey,cmdKey,hostKey,paramPropsList) {\n    //console.log(\"makeCommandElem \" + cmdKey);\n    const cmd = this.props.commands[cmdKey];\n    const cmdTypeKey = cmd.typeKey;\n    const cmdType = cmdTypes[cmdTypeKey];\n    const pattern = patterns[cmdTypeKey];\n    const vals = this.props.getValues(cmdKey).slice(0); // a shallow copy of the values\n    const clones = this.props.cloneValues;              // need to know if command value is cloned\n    // functions need to remember \"this\", hence the bind\n    const makeCmd = this.makeCmdLine.bind(this);          // func to build an ion cmd line\n    const getVals = this.props.getValues;                 // func to get values for command\n    const usedNodeKey = this.props.usedNodeKey;           // func to check if nodekey in use\n    const makeTypeOpts = this.props.makeTypeOptions;      // func to make dynamic clone option elems\n    const makeOptElems = this.props.makeOptionElems;      // func to make static option elems\n    const getOptText = this.props.getOptionText;          // func to get an option's text\n    const makePNote = this.makeParamNote;                 // func to make param note\n    const dispatch = this.props.dispatch;                 // pass through\n    return (\n      <Command\n        key={cmdKey}                   // unique id for command component\n        cmdKey={cmdKey}                // unique id for command\n        nodeKey={nodeKey}              // unique id for node of command\n        hostKey={hostKey}              // unique id for host of node\n        configKey={configKey}          // unique key of config file\n        cmdType={cmdType}              // schema object for command type\n        cmdTypeKey={cmdTypeKey}        // commmand type key\n        initValues={vals}              // command values\n        cmdPattern={pattern}           // cmd pattern string\n        cloneValues={clones}           // cloneValues object\n\n        makeCmd={makeCmd}              // cmd formatting func\n        getValues={getVals}            // value retrieval func\n        usedNodeKey={usedNodeKey}      // node key check func\n        makeTypeOptions={makeTypeOpts} // dynamic options building func\n        makeOptionElems={makeOptElems} // static options building func\n        getOptionText={getOptText}     // get option's text func\n        makeParamNote={makePNote}      // parameter note function\n        dispatch={dispatch}            // dispatch of state updates\n        lastUpdate={cmd.lastUpdate}    // last update\n        params={paramPropsList}\n      />\n    );                                               //\n  }\n  // initialize all Param props (will pass to Command to complete)\n  // return Param Props object\n  makeParamProps(pTypeKey,value) {\n    //console.log(\"makeParamProps pTypeKey: \" + pTypeKey)\n    const paramType = paramTypes[pTypeKey];\n    const def = paramType.defaultValue;\n    const copyClone = paramType.copyClone;\n    const pickClone = paramType.pickClone;\n    const optional = paramType.optional; \n    const showDefault = paramType.showDefault;\n    //console.log(\"paramType= \" + pTypeKey + \" selections: \" + JSON.stringify(selections));\n    return {\n      \"name\" : paramType.name,          // schema\n      \"typeKey\" : pTypeKey,             // user model\n      \"valueType\" : paramType.valType,  // schema\n      \"units\" : paramType.units,        // schema\n      \"defaultValue\": def,              // schema\n      \"initVal\" : value,                // user model\n      \"optional\" : optional,            // schema\n      \"copyClone\" : copyClone,          // schema \n      \"pickClone\": pickClone,           // schema\n      \"showDefault\": showDefault        // schema                \n    }\n  }\n  makeHeadElem(cols) {\n    var colElems = cols.map(\n      (name,idx) => { return (<th key={idx}>{name}</th>); }\n    );\n    var headElem = <thead key=\"head\"><tr>{colElems}</tr></thead>;\n    return headElem;\n  };\n  makeRowElem(rowKey,data) {\n    var dataElems = data.map(\n      (name,idx) => { return (<td key={idx}>{name}</td>); }\n    );\n    var rowElem = <tr key={rowKey}>{dataElems}</tr>;\n    return rowElem;\n  };\n  makeShowPopout() {\n    const report = this.makeShowNodes();\n    return (\n      <PopoutWindow title=\"POPOUT\" options={{outerHeight: '400 px', outerWidth: '900 px'}} onClosing={this.showPopout}>\n        {report}\n      </PopoutWindow>\n    );\n  };\n  makeShowEndpoints() {\n    //console.log(\"makeShowEndpoints\");\n    var epElemList = [];\n    var cmds = [];\n    const commandObjs = this.props.commands;\n    for (var cmdKey in commandObjs) {\n      if (commandObjs[cmdKey].typeName === 'endpoint')\n        cmds.push(commandObjs[cmdKey]);\n    };\n    // first sort by service num\n    cmds = cmds.sort( function(a,b) { return (Number(a.values[1]) > Number(b.values[1]) )  ? 1 : \n                                            ((Number(b.values[1]) > Number(a.values[1]) ) ? -1 : 0); } );\n    // then sort by node num\n    cmds = cmds.sort( function(a,b) { return (Number(a.values[0]) > Number(b.values[0]) )  ? 1 : \n                                            ((Number(b.values[0]) > Number(a.values[0]) ) ? -1 : 0); } );\n    const configs = this.props.configs;\n    var epCols = [\"Endpoint ID\",\"Node Name\",\"Service Num\",\"Disposition\",\"Queue Task\"];\n    var headElem = this.makeHeadElem(epCols);\n    for (var i=0; i<cmds.length;i++)  {\n      const cmdObj = cmds[i];\n      const configKey = cmdObj.configKey;\n      const configObj = configs[configKey];\n      const nodeKey = configObj.nodeKey;\n      const nodeNum = cmdObj.values[0];\n      const serviceNum = cmdObj.values[1];\n      const id = \"ipn:\" + nodeNum + '.' + serviceNum;\n      const dispCode = cmdObj.values[2];\n      const disp = (dispCode === 'x')?  \"discard\" : \"queue\" ;\n      const qTask = cmdObj.values[3];\n      const epElem = this.makeRowElem(id,[id,nodeKey,serviceNum,disp,qTask]);\n      epElemList.push(epElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{epElemList}</tbody></Table>;\n  };\n  makeShowHosts() {\n    //console.log(\"makeShowHosts\");\n    var hostElemList = [];\n    const hostObjs = this.props.hosts;\n    const nodeObjs = this.props.nodes;\n\n    var hosts = Object.keys(hostObjs).map( function(key) {return hostObjs[key] } );\n    var nodes = Object.keys(nodeObjs).map( function(key) {return nodeObjs[key] } );\n        //  sort by hostKey\n    hosts = hosts.sort( function(a,b) { return (a.id > b.id) ? 1 : ((b.id > a.id) ? -1 : 0); } );\n    var hostCols = [\"Host Name\",\"Description\",\"Linefeed\",\"Nodes\",\"IP Addresses\"];\n    var headElem = this.makeHeadElem(hostCols);\n    for (var i=0; i<hosts.length;i++)  {\n      var host = hosts[i];\n      var hostKey = host.id;\n      var desc = host.desc;\n      var linefeed = host.linefeed;\n      // find list of referencing nodes\n      var nodeList = [];\n      for (var j=0; j<nodes.length;j++) {\n        var node = nodes[j];\n        console.log(\"node j=\" + j + hostKey + \" jhost\" +  node.hostKey);\n        if (node.hostKey === hostKey)\n          nodeList.push(node.id);\n      }\n      const ipaddrs = this.props.ipaddrs;\n      var ipAddrList = [];\n      for (var k=0; k<host.ipAddrKeys.length; k++) {\n        var iKey = host.ipAddrKeys[k];\n        ipAddrList.push(ipaddrs[iKey].ipAddr)\n      }\n      var nodeStr = nodeList.join();\n      var addrStr = ipAddrList.join();\n      var hostElem = this.makeRowElem(hostKey,[hostKey,desc,linefeed,nodeStr,addrStr]);\n      hostElemList.push(hostElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{hostElemList}</tbody></Table>;\n  };\n  makeShowNodes() {\n    //console.log(\"makeShowNodes\");\n    var nodeElemList = [];\n    const nodeObjs = this.props.nodes;\n    var nodes = Object.keys(nodeObjs).map( function(key) {return nodeObjs[key] } );\n        //  sort by nodeKey\n    nodes = nodes.sort( function(a,b) { return (a.id > b.id) ? 1 : ((b.id > a.id) ? -1 : 0); } );\n    var nodeCols = [\"Node Name\",\"Description\",\"Address\",\"Host Name\",\"Config Files\"];\n    var headElem = this.makeHeadElem(nodeCols);\n    for (var i=0; i<nodes.length;i++)  {\n      var node = nodes[i];\n      var nodeKey = node.id;\n      var desc = node.longName;;\n      var nodeAddr = \"ipn:\" + node.ionNodeNum;\n      var host = node.hostKey;\n      var configStr = node.configKeys.join();\n      var nodeElem = this.makeRowElem(nodeKey,[nodeKey,desc,nodeAddr,host,configStr]);\n      nodeElemList.push(nodeElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{nodeElemList}</tbody></Table>;\n  };\n  makeShowConfigs() {\n    //console.log(\"makeShowConfigs\");\n    var configElemList = [];\n    const configObjs = this.props.configs;\n    var configs = Object.keys(configObjs).map( function(key) {return configObjs[key] } );\n    //  first, sort by nodeKey\n    configs = configs.sort( function(a,b) { return (a.nodeKey > b.nodeKey) ? 1 : ((b.nodeKey > a.nodeKey) ? -1 : 0); } );\n    //  then, sort by configKey\n    configs = configs.sort( function(a,b) { return (a.id > b.id) ? 1 : ((b.id > a.id) ? -1 : 0); } );\n    var configCols = [\"Config File\",\"Node/Graph Name\",\"Command Count\"];\n    var headElem = this.makeHeadElem(configCols);\n    for (var i=0; i<configs.length;i++)  {\n      var config = configs[i];\n      var configKey = config.id;\n      var nodeKey = config.nodeKey;\n      var cnt = config.cmdKeys.length;\n      var configElem = this.makeRowElem(configKey,[configKey,nodeKey,cnt]);\n      configElemList.push(configElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{configElemList}</tbody></Table>;\n  };\n  makeShowCommands() {\n    //console.log(\"makeShowCommands\");\n    var cmdElemList = [];\n    const commandObjs = this.props.commands;\n\n    var cmds = Object.keys(commandObjs).map(function(key) {return commandObjs[key] } );\n    // first sort by configKey\n    cmds = cmds.sort( function(a,b) { return (a.configKey > b.configKey) ? 1 : ((b.configKey > a.configKey) ? -1 : 0); } );\n    // then sort by typeKey\n    cmds = cmds.sort( function(a,b) { return (a.typeKey > b.typeKey) ? 1 : ((b.typeKey > a.typeKey) ? -1 : 0); } );\n    var cmdCols = [\"Command Type\",\"Config File\",\"Last Update\",\"Warning(s)\",\"Command\"];\n    var headElem = this.makeHeadElem(cmdCols);\n    for (var i=0; i<cmds.length;i++)  {\n      const cmdObj = cmds[i];\n      const cmdKey = cmdObj.id;\n      const type = cmdObj.typeKey;\n      const file = cmdObj.configKey;\n      const timeTag = cmdObj.lastUpdate;\n      const cmdStr = this.makeCmdLine(type,cmdObj.values);\n      var warns = \"\";\n      if (cmdStr.indexOf(\"??\") > -1) {\n        warns += \"missingParam\";  \n      }\n      var cmdElem = this.makeRowElem(cmdKey,[type,file,timeTag,warns,cmdStr]);\n      cmdElemList.push(cmdElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{cmdElemList}</tbody></Table>;\n  };\n  makeShowSpans() {\n    //console.log(\"makeShowSpans\");\n    var spanElemList = [];\n    var spans = [];\n    const cmdObjs = this.props.commands;\n    for (var cmdKey in cmdObjs) \n      if(cmdObjs[cmdKey].typeName.indexOf(\"span\") >= 0)\n        spans.push(cmdObjs[cmdKey]);\n    // first sort by configKey\n    spans = spans.sort( function(a,b) { return (a.configKey > b.configKey) ? 1 : ((b.configKey > a.configKey) ? -1 : 0); } );\n    // then sort by typeKey\n    spans = spans.sort( function(a,b) { return (a.typeName > b.typeName) ? 1 : ((b.typeName > a.typeName) ? -1 : 0); } );\n    var spanCols = [\"Command Type\",\"Config File\",\"Last Update\",\"Command\"];\n    var headElem = this.makeHeadElem(spanCols);\n    for (var i=0; i<spans.length;i++)  {\n      const cmdObj = spans[i];\n      const cmdKey = cmdObj.id;\n      const file = cmdObj.configKey;\n      const type = cmdObj.typeName;\n      const fullType = cmdObj.typeKey;\n      const timeTag = cmdObj.lastUpdate;\n      const cmdStr = this.makeCmdLine(fullType,cmdObj.values);\n      var spanElem = this.makeRowElem(cmdKey,[type,file,timeTag,cmdStr]);\n      spanElemList.push(spanElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{spanElemList}</tbody></Table>;\n  };\n  makeShowInducts() {\n    //console.log(\"makeShowInducts\");\n    var inductElemList = [];\n    const cVals = this.props.cloneValues;\n    var cloneVals = Object.keys(cVals).map(function(key) {return cVals[key] } );\n    // first sort by duct name (value)\n    cloneVals = cloneVals.sort( function(a,b) { return (a.value > b.value) ? 1 : ((b.value > a.value) ? -1 : 0); } );\n    // then sort by type\n    cloneVals = cloneVals.sort( function(a,b) { return (a.type > b.type) ? 1 : ((b.type > a.type) ? -1 : 0); } );\n    var inductCols = [\"Protocol\",\"Induct Name\",\"To Node\",\"Outducts From Node(s)\"];\n    var headElem = this.makeHeadElem(inductCols);\n    for (var cKey in cloneVals)  {\n      const cloneObj = cloneVals[cKey];\n      var type = cloneObj.type;\n      var ductType = \"\";\n      var idx = type.indexOf(\"Induct\");  // an Induct Name clone value?\n      if (idx >= 0) \n        ductType = type.substring(0,idx);\n      else\n        continue;\n      const nodeKey = cloneObj.nodeKey;\n      const ductName = cloneObj.value;\n      console.log(\"inductName: \" + ductName);\n      const clones = cloneObj.clones;\n      let refList = [];\n      for (var i=0; i< clones.length; i++) {\n        let clone = clones[i];\n        let cmdKey = clone.cmdKey;\n        let nKey = this.props.getNodeKey(cmdKey);\n        refList.push(nKey);\n        console.log(\"cmdKey: \" + cmdKey + \" nodeKey: \" + nKey);\n      }\n      let refs = JSON.stringify(refList);\n      var inductElem = this.makeRowElem(cKey,[ductType,ductName,nodeKey,refs]);\n      inductElemList.push(inductElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{inductElemList}</tbody></Table>;\n  };\n  makeShowOutducts() {\n    //console.log(\"makeShowOutducts\");\n    var inductNodes = {};      // lookup for node destination\n    var outductElemList = [];\n    const cVals = this.props.cloneValues;\n    var clones = Object.keys(cVals).map(function(key) {return cVals[key] } );\n    // first sort by duct name (value)\n    clones = clones.sort( function(a,b) { return (a.value > b.value) ? 1 : ((b.value > a.value) ? -1 : 0); } );\n    // then sort by type\n    clones = clones.sort( function(a,b) { return (a.type > b.type) ? 1 : ((b.type > a.type) ? -1 : 0); } );\n    // build lookup for induct names\n    for (var cKey in clones)  {\n      const cloneObj = clones[cKey];\n      var type = cloneObj.type;\n      var idx = type.indexOf(\"Induct\");  // an Induct Name clone value?\n      if (idx >= 0) {\n        const nodeKey = cloneObj.nodeKey;\n        const ductName = cloneObj.value;\n        inductNodes[ductName] = nodeKey;\n      }\n    }\n    var outductCols = [\"Protocol\",\"Outduct Name\",\"From Node\",\"To Node\"];\n    var headElem = this.makeHeadElem(outductCols);\n    for (cKey in clones)  {\n      const cloneObj = clones[cKey];\n      type = cloneObj.type;\n      var ductType = \"\";\n      idx = type.indexOf(\"Outduct\");  // an Induct Name clone value?\n      if (idx >= 0) \n        ductType = type.substring(0,idx);\n      else\n        continue;\n      const fromNode = cloneObj.nodeKey;\n      const ductName = cloneObj.value;\n      const toNode = inductNodes[ductName];\n      var outductElem = this.makeRowElem(cKey,[ductType,ductName,fromNode,toNode]);\n      outductElemList.push(outductElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{outductElemList}</tbody></Table>;\n  };\n  makeShowClones() {\n    console.log(\"makeShowClones\");\n    var cloneElemList = [];\n    const cmds = this.props.commands;            // command objects\n    const cVals = this.props.cloneValues;        // clone value objects\n    var cloneVals = Object.keys(cVals).map(function(key) {return cVals[key] } );\n    // first sort by value to clone (value)\n    cloneVals = cloneVals.sort( function(a,b) { return (a.value > b.value) ? 1 : ((b.value > a.value) ? -1 : 0); } );\n    // then sort by type\n    cloneVals = cloneVals.sort( function(a,b) { return (a.type > b.type) ? 1 : ((b.type > a.type) ? -1 : 0); } );\n    var cloneCols = [\"Origin Type\",\"Origin Value\",\"Origin Node\",\"Target Config File\",\"Command with Cloned Value\",];\n    var headElem = this.makeHeadElem(cloneCols);\n    for (var cKey in cloneVals)  {\n      const cloneObj = cloneVals[cKey];\n      var type = cloneObj.type;\n      const nodeKey = cloneObj.nodeKey;\n      const value = cloneObj.value;\n      //console.log(\"value: \" + value);\n      const clones = cloneObj.clones;\n      for (var i=0; i< clones.length; i++) {\n        let elemKey = cKey + i;\n        let clone = clones[i];\n        let cmdKey = clone.cmdKey;\n        //console.log(\"cmdKey: \" + cmdKey);\n        let cmdObj = cmds[cmdKey];\n        let typeKey = cmdObj.typeKey;\n        let params = cmdObj.values;\n        let configKey = cmdObj.configKey;\n        let cmdLine = this.makeCmdLine(typeKey,params);\n        var cloneElem = this.makeRowElem(elemKey,[type,value,nodeKey,configKey,cmdLine]);\n        cloneElemList.push(cloneElem);\n      }\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{cloneElemList}</tbody></Table>;\n  };\n  makeShowAlerts() {\n    console.log(\"makeShowAlerts\");\n    var alertElemList = [];\n    const alerts = this.checkModel();\n    var alertCols = [\"Model Entity\",\"Name\",\"Level\",\"Alert Message\"];\n    var headElem = this.makeHeadElem(alertCols);\n    for (var i=0; i<alerts.length;i++)  {\n      var alert = alerts[i];\n      var entity = alert.type;\n      var name = alert.name;\n      var level = alert.level;\n      var msg = alert.msg;\n      var alertElem = this.makeRowElem(i,[entity,name,level,msg]);\n      alertElemList.push(alertElem);\n    }\n    return <Table striped condensed hover>{headElem}<tbody>{alertElemList}</tbody></Table>;\n  };\n  // check model for errors\n  checkModel() {\n    let alerts = [];\n    const modelName = this.props.name;\n    const hosts = this.props.hosts;\n    const nodes = this.props.nodes;\n    const graphs = this.props.graphs;\n    const configs = this.props.configs;\n    const commands = this.props.commands;\n    // Model-level\n    if (Object.keys(graphs).length === 0)\n      alerts.push({\"type\": \"IonModel\", \"name\": modelName, \"level\":\"warn\", \"msg\":\"No graphs created.\"});\n    if (Object.keys(nodes).length === 0)\n      alerts.push({\"type\": \"IonModel\", \"name\": modelName, \"level\":\"warn\", \"msg\":\"No nodes created.\"});\n    // Node-level   required configs\n    const reqConfigs = [\"ionrc\", \"ionconfig\",\"ipnrc\"];\n    // TODO : add req for bprc of either v6 or v7\n    // Config-level required command types\n    var reqCmds = {}; \n    reqCmds[\"ionrc\"] = [\"initialize\",\"start\"];\n    reqCmds[\"bpv6rc\"] = [\"initialize\",\"scheme\",\"start\"];\n    reqCmds[\"bpv7rc\"] = [\"initialize\",\"scheme\",\"start\"];\n    reqCmds[\"ionconfig\"] = [];\n    reqCmds[\"ipnrc\"] = [\"plan\"];\n    reqCmds[\"ltprc\"] = [\"initialize\"];\n    reqCmds[\"bssprc\"] = [\"initialize\"];\n    // host loop\n    for (var hostKey in hosts) {\n      const host = hosts[hostKey];\n      if (host.ipAddrKeys.length === 0) {\n        let msg = \"has no IP addresses defined.\";\n        alerts.push({\"type\": \"Host\", \"name\": hostKey, \"level\":\"warn\", \"msg\": msg});\n      }\n    }\n    // node loop\n    for (var nodeKey in nodes) {\n      const node = nodes[nodeKey];\n      if (node.hostKey === \"\") {\n        let msg = \"has no host machine assigned.\";\n        alerts.push({\"type\": \"Node\", \"name\": nodeKey, \"level\":\"warn\", \"msg\": msg});\n      }\n      var ionVerSeqNo = this.getIonVerSeqNo(nodeKey);\n      var ionVer = versions[ionVerSeqNo].ionVersion;\n      let protFlags = {};  // dict for protocol cmd existence\n      let ductFlags = {};  // dict for duct cmd existence by protocol\n      console.log(\"checking commands for version seq: \" + ionVerSeqNo.toString())\n      var nconfs = node.configKeys;\n      for (let i=0; i<reqConfigs.length; i++) {\n        let chkConf = reqConfigs[i];\n        let missing = true;\n        for (let j=0; j<nconfs.length; j++) {\n          if (nconfs[j].indexOf(chkConf) >= 0)\n            missing = false;\n        }\n        if (missing) {\n          let msg = \"Has no \" + chkConf + \" file.\";\n          alerts.push({\"type\": \"Node\", \"name\": nodeKey, \"level\":\"warn\", \"msg\": msg});\n        }\n      }\n      console.log(\"+++ conf count: \" + nconfs.length);\n      // node configs loop\n      for (let k=0; k<nconfs.length; k++) {\n        let confKey = nconfs[k];\n        var configObj = configs[confKey];\n        let chkConf = configObj.configType;\n        let cmdCounts = {};   // dict for cmd type counts\n\n        let missed = [];   // assume all required commands missing...will drop from list if found\n        if (reqCmds.hasOwnProperty(chkConf) ) \n          missed = reqCmds[chkConf];\n        console.log(\"+++ checking reqd cmds: \" + missed.toString());\n        // node config commands loop\n        for (let n=0; n<configObj.cmdKeys.length; n++) { \n          let cmdKey = configObj.cmdKeys[n];\n          let cmdTypeKey = commands[cmdKey].typeKey;\n          var cmdType = cmdTypes[cmdTypeKey];\n          console.log(\"checking command type: \" + cmdTypeKey + \" \" );\n          if (cmdType.verFrom > ionVerSeqNo) {\n            let msg = \"Node \" + nodeKey + \"(\" + ionVer + \") needs earlier variant of this command\";\n            alerts.push({\"type\": \"Command\", \"name\": cmdTypeKey, \"level\":\"warn\", \"msg\": msg});\n          }\n          if (cmdType.verThru < ionVerSeqNo) {\n            let msg = \"Node \" + nodeKey + \"(\" + ionVer + \") needs later variant of this command\";\n            alerts.push({\"type\": \"Command\", \"name\": cmdTypeKey, \"level\":\"warn\", \"msg\": msg});\n          }\n          // keep count of each cmdType\n          if (cmdCounts.hasOwnProperty(cmdTypeKey))\n            cmdCounts[cmdTypeKey] += 1; \n          else \n            cmdCounts[cmdTypeKey] = 1;\n\n          for (let c=0; c<missed.length; c++) {\n            let reqCmd = missed[c];\n            if (cmdTypeKey.indexOf(reqCmd) >= 0) {\n              missed.splice(c,1);  // drop this one from missing list\n              break;               // and exit loop\n            }\n          }\n          // check for missing command parameters\n          let cmdObj = commands[cmdKey];\n          let cmdStr = this.makeCmdLine(cmdTypeKey,cmdObj.values);\n          console.log(\"cmdStr: \" + cmdStr);\n          if (cmdStr.indexOf(\"??\") > -1) {\n            let msg = \"Missing parameter(s).\";\n            let cmdTag = nodeKey + \".\" + cmdTypeKey;\n            alerts.push({\"type\": \"Command\", \"name\": cmdTag, \"level\":\"warn\",\"msg\": msg});\n          }\n          // check for missing protocol cmds\n          if (cmdStr.indexOf(\"induct\")  > -1 || \n              cmdStr.indexOf(\"outduct\") > -1 ) {\n             let pList = cmdStr.split(\" \").filter(Boolean);  // get non-empty tokens\n             let prot = pList[2];   // 3rd token should be protocol\n             ductFlags[prot] = 1;  // don't need full count\n          }\n          if (cmdStr.indexOf(\"protocol\")  > -1) {\n             let pList = cmdStr.split(\" \").filter(Boolean);  // get non-empty tokens\n             let prot = pList[2];   // 3rd token should be protocol\n             protFlags[prot] = 1;  // don't need full count\n          }\n        }  // end of command loop\n        // check for incorrect command duplicates\n        console.log(\"***** cmdCounts \" + JSON.stringify(cmdCounts));\n        for (var cntKey in cmdCounts) {\n          if (cmdCounts[cntKey] > 1) {\n            console.log(\"***** \" + cntKey + \" count =\" + cmdCounts[cntKey].toString() );\n            if (!cmdTypes[cntKey].hasOwnProperty(\"multiple\")) {   // singleton command?\n              let msg = \"Improper duplicate command: \" + cntKey;\n              alerts.push({\"type\": \"Config\", \"name\": confKey, \"level\":\"warn\", \"msg\": msg});\n            }\n          }\n        }\n        // alert any missing commands\n        for (let m=0; m<missed.length; m++) {\n          let missedCmd = missed[m];\n          let msg = \"Has no \" + missedCmd + \" command.\";\n          alerts.push({\"type\": \"Config\", \"name\": confKey, \"level\":\"warn\", \"msg\": msg});\n        }\n      } //end of config loop\n      console.log(\"***** ductFlags \" + JSON.stringify(ductFlags));\n      console.log(\"***** protFlags \" + JSON.stringify(protFlags));\n      // alert any missing protocol commands\n      for (var prot in ductFlags) {\n        if (!protFlags.hasOwnProperty(prot)) {\n          let msg = \"The bprc is missing the protocol \" + prot + \" command.\";\n          alerts.push({\"type\": \"Node\", \"name\": nodeKey, \"level\":\"error\", \"msg\": msg});\n        }\n      }\n    } // end of node loop\n\n    return alerts;\n  }\n  makeSelectFormElem(val,handler,options) {\n    var form =\n      <FormControl\n        readOnly={!this.state.editMode}\n        disabled={!this.state.editMode}\n        bsSize=\"sm\"\n        componentClass=\"select\"\n        value={val}\n        onChange={handler}\n        >{options}\n      </FormControl>;\n    return form;\n  }\n  // show current value with selection widget\n  makeShowForm(val) {\n    var form =\n      <FormControl\n        readOnly=\"true\"\n        bsSize=\"sm\"\n        type=\"text\"\n        value={val}\n      />;\n    return form;\n  }\n  makeIonEditor() {\n    //console.log(\">>makeModelElems \" + JSON.stringify(this.state));\n    var modelElems = [];\n    const icon = 'remove';\n    const head  = \n      <Row key=\"head\">\n        <Col sm={4}><Label bsSize=\"lg\" bsStyle=\"default\">ION Model Editor</Label></Col>\n        <Col sm={1}><Button bsSize=\"sm\" bsStyle=\"success\"  onClick={this.noedit}><Glyphicon glyph={icon} /></Button></Col>\n      </Row>;\n    modelElems.push(head);\n    const nameElem = this.makeModelElem(\"name\",\"text\",this.state.name,\"ION Model Name\",1,false,\"\");\n    modelElems.push(nameElem);\n    const descElem = this.makeModelElem(\"desc\",\"text\",this.state.desc,\"Description\",2,false,\"\");\n    modelElems.push(descElem);\n    const numElem  = this.makeModelElem(\"nextNodeNum\",\"number\",this.state.nextNodeNum,\"Next Node Num\",1,false,\"(for new Node)\");\n    modelElems.push(numElem);\n    // build contactGraph selector\n    const contactFunc = this.handleIonChange.bind(null,\"currentContacts\");\n    const graphs = this.props.graphs;\n    var opts = [];\n    for (var name in graphs) {\n      var graph = graphs[name];\n      var option = name;   // get the first & only key\n      var text = graph[\"desc\"];\n      opts.push(<option key={option} value={option}>{option}    == {text}</option>);\n    };\n    opts.unshift(<option key=\"none\" value=\"none\">(Select)</option>);\n    console.log(\"graph options:\");\n    var contacts = this.state.currentContacts;\n    var show = this.makeShowForm(contacts);\n    var form = this.makeSelectFormElem(contacts,contactFunc,opts);\n    const contElem = \n      <Row key=\"contacts\">\n        <Col className=\"text-right\" sm={2}><b>Current Contacts Name</b></Col>\n        <Col sm={1} value={contacts}>{show}</Col>\n        <Col sm={2} type=\"select\" value={contacts} readOnly=\"false\">{form}</Col>\n        <Col sm={2} ></Col>\n      </Row>;\n    modelElems.push(contElem);\n\n    return (\n      <div>\n        {modelElems}\n      </div>\n    );\n  };\n  makeIonViewer() {\n    //console.log(\">>makeModelElems \" + JSON.stringify(this.state));\n    var modelElems = [];\n    const head  = <Row key=\"head\"><Col sm={2}> <Label bsSize=\"lg\" bsStyle=\"default\">ION Model Viewer</Label></Col></Row>;\n    modelElems.push(head);\n    const nameElem = this.makeModelElem(\"name\",\"text\",this.state.name,\"ION Model Name\",1,true,\"\");\n    modelElems.push(nameElem);\n    const descElem = this.makeModelElem(\"desc\",\"text\",this.state.desc,\"Description\",2,true,\"\");\n    modelElems.push(descElem);\n    const numElem  = this.makeModelElem(\"nextNodeNum\",\"text\",this.state.nextNodeNum,\"Next Node Num\",1,true,\"\");\n    modelElems.push(numElem);\n    const contactsElem  = this.makeModelElem(\"currentContacts\",\"text\",this.state.currentContacts,\"Current Contacts Graph\",1,true,\"\");\n    modelElems.push(contactsElem);\n\n    return (\n      <div>\n        {modelElems}\n      </div>\n    );\n  };\n  makeModelElem(prop,type,val,label,size,read,note) {\n    //console.log(\">>MakeModelElem \" + prop + ' ' + type + ' ' + val + ' ' + size);\n    const form =\n        <FormControl readOnly={read} bsSize=\"sm\" type={type} value={val} onChange={this.handleIonChange.bind(null,prop)} />;\n    return (\n      <Row key={label}>\n        <Col className=\"text-right\" sm={2}><b>{label}</b></Col>\n        <Col sm={size} value={val}>{form}</Col>\n        <Col sm={2} value={2}>{note}</Col>\n      </Row>\n    );\n  };\n  makeSurveyElem() {\n    return (\n      <div>\n        <hr />\n        <Row>\n          <Col sm={1}></Col>\n          <Col className=\"text-left\"  sm={2}><b>Click Popout Survey Topic(s):</b></Col>\n          <Col sm={6}> \n            <ButtonToolbar>\n              <SurveyPopout label=\"Hosts\" showSurvey={this.makeShowHosts.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Nodes\" showSurvey={this.makeShowNodes.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Configs\" showSurvey={this.makeShowConfigs.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Commands\" showSurvey={this.makeShowCommands.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Endpoints\" showSurvey={this.makeShowEndpoints.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Inducts\" showSurvey={this.makeShowInducts.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Outducts\" showSurvey={this.makeShowOutducts.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Spans\" showSurvey={this.makeShowSpans.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Clones\" showSurvey={this.makeShowClones.bind(this)}></SurveyPopout>\n              <SurveyPopout label=\"Alerts\" showSurvey={this.makeShowAlerts.bind(this)}></SurveyPopout>\n            </ButtonToolbar>\n          </Col>\n        </Row>\n      </div>\n    );\n  };\n  render() {\n    //console.log(\"IonModel render begin. state\" +JSON.stringify(this.state));\n    console.log(\"IonModel render begin.\");\n    const name = this.state.name;\n    const editMode = this.state.editMode;\n    const viewMode = this.state.viewMode;\n    const surveyMode = this.state.surveyMode;\n    const showPopoutMode = this.state.showPopoutMode;\n    const expandMode = this.state.expandMode;\n\n    const ionHosts    = expandMode? this.makeHostListElem(name) : \"\";\n    const ionNodeList = expandMode? this.makeIonNodeListElem(name) : \"\";\n    const graphList   = expandMode? this.makeGraphListElem(name) : \"\";\n\n    const showSurveyTag = surveyMode?  \"Hide Surveys\" : \"Show Surveys\" ;\n    const offerSurveys = surveyMode? this.makeSurveyElem() : \"\";\n    const showPopoutWin = showPopoutMode? this.makeShowPopout() : \"\";\n    const editLabel = editMode?  'Submit' : 'Edit'\n    const viewLabel = viewMode?  'Hide' : 'Show'\n    const expandIcon = expandMode? 'chevron-down' : 'chevron-right';\n    const dimSaveION = false;\n    const dimSaveConfigs = false;\n\n    var alerts = this.checkModel();   // any alerts?\n\n    const alertit =  alerts.length? <Alert bsStyle=\"danger\"><b>See Alerts (in Surveys)</b></Alert> : \"\";\n\n    let viewPanel = null;\n    if (viewMode)\n      if (editMode)\n        viewPanel = this.makeIonEditor();\n      else\n        viewPanel = this.makeIonViewer();\n\n    console.log(\"IonModel render return next.\")\n    return (\n      <div>\n        <hr />\n        <Row>\n          <Col className=\"text-left\"  sm={1}><Label bsSize=\"sm\" bsStyle=\"default\">ION Model</Label></Col>\n          <Col className=\"text-right\" sm={1}><b>{name}</b></Col>\n          <Col className=\"text-left\"  sm={2}>{this.state.desc}</Col>\n          <Col sm={6}> \n            <ButtonToolbar>\n              <Button bsSize=\"sm\" bsStyle=\"primary\" onClick={this.edit}>{editLabel}</Button>\n              <Button bsSize=\"sm\" bsStyle=\"info\" onClick={this.view}>{viewLabel}</Button>\n              <Button bsSize=\"sm\" bsStyle=\"info\" onClick={this.showSurveys}>{showSurveyTag}</Button>\n              <Button bsSize=\"sm\" bsStyle=\"primary\" disabled={dimSaveION}  onClick={this.saveModel}>Save Model</Button>\n              <Button bsSize=\"sm\" bsStyle=\"primary\" disabled={dimSaveConfigs}  onClick={this.saveConfigs}>Save Configs</Button>\n              <Button bsSize=\"sm\" bsStyle=\"success\" onClick={this.expand}><Glyphicon glyph={expandIcon}/>{' '}</Button>\n            </ButtonToolbar>\n          </Col>\n          <Col sm={2}> {alertit} </Col>\n        </Row>\n        {offerSurveys}\n        {showPopoutWin}\n        <Panel collapsible expanded={viewMode}>\n          {viewPanel}\n        </Panel>\n        <Panel  collapsible expanded={expandMode}>\n          {ionHosts}\n          {ionNodeList}\n          {graphList}\n        </Panel>\n      </div>\n    );\n\n  };\n  expand = () => { // activated by expand/contract shutter icon\n    var newState = Object.assign({},this.state);\n    var expandMode = this.state.expandMode;\n    if (expandMode)\n      console.log(\"let's close-up ion model list!\");\n    else\n      console.log(\"let's expand ion mode list!\");\n    newState.expandMode = !expandMode;  // toggling flag changes render\n    this.setState (newState);\n  };\n  edit = () => {   // activated by Edit/Submit button\n    var newState = Object.assign({},this.state);\n    const editMode = this.state.editMode;\n    if (editMode)\n      this.submit();\n    else {\n      console.log(\"let's edit!\");\n      newState.viewMode = true;   // force viewing\n    }\n    newState.editMode = !editMode;  // toggle mode\n    this.setState (newState);\n  };\n  noedit = () => {   // activated by Edit/Submit button\n    var newState = Object.assign({},this.state);\n    newState.editMode = false;   // cancel editing\n    newState.viewMode = false;   // cancel viewing\n    this.setState (newState);\n  };\n  submit = () => {    // callable by edit (above)\n    console.log(\"submit ion model updates!\" + JSON.stringify(this.state.desc));\n    var ionModel = { \n      \"name\": this.state.name,\n      \"desc\": this.state.desc,\n      \"nextNodeNum\": this.state.nextNodeNum,\n      \"currentContacts\": this.state.currentContacts\n    };\n    var tran = {\n      action: \"UPDATE-ION-MODEL\",\n      ionModel: ionModel\n    };\n    this.props.dispatch(tran);\n  };\n  view = () => { // activated by view/hide button\n    var newState = Object.assign({},this.state);\n    var viewMode = this.state.viewMode;\n    if (viewMode)\n      console.log(\"let's hide view panel!\");\n    else\n      console.log(\"let's show view panel!\");\n    newState.viewMode = !viewMode;\n    this.setState (newState);\n  };\n  showSurveys = () => {\n    console.log(\">>show Surveys!\");\n    const newMode = !this.state.surveyMode;\n    this.setState({\n      surveyMode: newMode\n    });\n  };\n  showPopout = () => {\n    console.log(\">>show Popout!\");\n    const newMode = !this.state.showPopoutMode;\n    if (!newMode) {   // time ot close?\n      var myPopout = window.open(\"\",\"POPOUT\");\n      if (myPopout) {\n        console.log(\"myPopout lives!!\");\n        myPopout.close();\n      }\n      else\n        console.log(\"myPopout null-ish!!\");\n      //myPopout.close();\n    }\n    this.setState({\n      showPopoutMode: newMode\n    });\n  };\n  saveModel = () => {\n    console.log(\"save ION model!\");\n    const modelObj = this.makeModelObj();\n    const modelJson = JSON.stringify(modelObj,null,2);\n    const blob = new Blob( [modelJson], {type: \"text/plain; charset=utf-8\"} );\n    const modelName = this.state.name + \".json\";\n    console.log(\"save ION model to: \" + modelName);\n    saveAs(blob, modelName, true);   // true = disable autoBOM\n  };\n  saveConfigs = () => {\n    console.log(\"let's save all config files in a zip file!\");\n    var zip = new JSZip();\n    var rootdir = zip.folder(this.props.name);   // the network name\n    // build common contact graph\n    const graphKey = this.props.currentContacts + \".cg\";\n    var graphLines = this.makeCmdLines(graphKey);\n\n\n    // build config files node-by-node\n    for (var nodeKey in this.props.nodes) {\n      const node = this.props.nodes[nodeKey]\n      var nodedir = rootdir.folder(node.id);\n      const confKeys = node.configKeys;\n      var lf = \"\\n\";   // assign linefeed format for text files\n      var host = this.props.hosts[node.hostKey];  // get host object of node\n      if (host.linefeed === 'windows')            // windows is different\n        lf = \"\\r\\n\";\n\n      for (let j=0; j<confKeys.length; j++) {\n        var configKey = confKeys[j];\n        console.log(\"Saving config file: \" + configKey);\n        const cmdLines = this.makeCmdLines(configKey);\n        const page = cmdLines.join(lf) + lf;\n        nodedir.file(configKey,page);\n      };\n      let graphPage = graphLines.join(lf) + lf;\n      nodedir.file(graphKey,graphPage);  // add common contact graph\n      // ... and build start scripts for each node\n      let startName = \"start_\" + nodeKey + \".sh\";\n      console.log(\"Saving start file: \" + startName);\n      let cmdLines = this.makeStartLines(nodeKey);\n      let page = cmdLines.join(lf) + lf;\n      nodedir.file(startName,page);\n    };\n    const zipname = this.props.name + \".zip\";\n    zip.generateAsync( {type:\"blob\"}).then(function(content) {\n      saveAs(content, zipname, true);   // true = disable autoBOM\n    });\n    console.log(\"finished zip file!??\");\n  };\n  handleIonChange = (prop,e) => {\n    console.log(\"a value change of\" + prop +  e);\n    var newState = Object.assign({},this.state);\n    console.log(\">>> param old value = \" + newState.desc);\n    newState[prop] = e.target.value;\n    this.setState (newState);\n    e.preventDefault();\n  };\n}\n\nIonModel.propTypes = {\n  name: PropTypes.string.isRequired,\n  desc: PropTypes.string.isRequired,\n  nextNodeNum: PropTypes.number.isRequired,\n  currentContacts: PropTypes.string.isRequired,\n\n  hosts: PropTypes.Arrays.isRequired,\n  ipaddrs: PropTypes.Arrays.isRequired,\n  graphs: PropTypes.Arrays.isRequired,\n  nodes: PropTypes.Arrays.isRequired,\n  configs: PropTypes.Arrays.isRequired,\n  commands: PropTypes.Arrays.isRequired,\n  cloneValues: PropTypes.Arrays.isRequired,\n\n  getNodeKey: PropTypes.func.isRequired,      // func to find nodeKey from a cmdKey\n  isGoodName: PropTypes.func.isRequired,      // func to validate name\n  isGoodNodeKey: PropTypes.func.isRequired,   // func to validate nodeKey not in use\n  isGoodNodeNum: PropTypes.func.isRequired,   // func to validate node num not in use\n  checkModel: PropTypes.func.isRequired,      // func to check the entire model\n  getValues:  PropTypes.func.isRequired,      // get command value list\n  makeOptionElems: PropTypes.func.isRequired, // func to provide options\n  makeTypeOptions: PropTypes.func.isRequired, // func to make type options\n  getOptionText: PropTypes.func.isRequired,   // func to get option text\n\n  dispatch: PropTypes.func.isRequired,        // func to handle transactions centrally\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}